server:
  port: 8081

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/heartsphere?useUnicode=true&characterEncoding=utf8mb4&useSSL=false&serverTimezone=Asia/Shanghai
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQL8Dialect
        format_sql: true
        use_sql_comments: true
  mvc:
    pathmatch:
      matching-strategy: ANT_PATH_MATCHER
  http:
    encoding:
      charset: UTF-8
      enabled: true
      force: true
  jackson:
    default-property-inclusion: non_null
    serialization:
      write-dates-as-timestamps: false
      write-date-timestamps-as-nanoseconds: false
    mapper:
      accept-case-insensitive-enums: true
    time-zone: Asia/Shanghai
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB
  # CORS 配置
  web:
    cors:
      allowed-origins: '*'
      allowed-methods: GET, POST, PUT, DELETE, OPTIONS
      allowed-headers: '*'
      allow-credentials: true
      exposed-headers: '*'

# JWT 配置
jwt:
  secret: ${JWT_SECRET:your-secret-key-change-in-production}
  expiration: 86400000 # 24小时
  refresh-expiration: 604800000 # 7天

# 微信登录配置（微信开放平台网站应用）
wechat:
  app-id: ${WECHAT_APP_ID:your-wechat-app-id}
  app-secret: ${WECHAT_APP_SECRET:your-wechat-app-secret}
  redirect-uri: ${WECHAT_REDIRECT_URI:http://localhost:8081/api/wechat/callback}

# 图片存储配置
app:
  image:
    storage:
      type: ${IMAGE_STORAGE_TYPE:local} # local, oss, s3
      local:
        path: ${IMAGE_STORAGE_PATH:./uploads/images}
      base-url: ${IMAGE_BASE_URL:http://localhost:8081/api/images}  # 注意：端口应与server.port一致，实际访问URL会自动添加 /files/ 前缀
      max-size: ${IMAGE_MAX_SIZE:10485760} # 10MB (单位：字节)

# 日志配置
logging:
  level:
    # 根日志级别
    root: INFO
    # 应用包日志级别
    com.heartsphere: DEBUG
    # Hibernate SQL日志
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
    org.hibernate.type: TRACE
    # Spring Data JPA日志
    org.springframework.data.jpa: DEBUG
    # 数据库连接池日志
    com.zaxxer.hikari: DEBUG
    # Spring Security日志
    org.springframework.security: DEBUG
    # HTTP请求日志
    org.springframework.web: DEBUG
    # SQL语句和参数日志
    org.hibernate.engine.internal: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# Spring AI Alibaba配置（暂时禁用，等代码完善后再启用）
spring:
  ai:
    dashscope:
      api-key: ${DASHSCOPE_API_KEY:}
      enabled: false  # 暂时禁用自动配置

