server:
  port: 8081

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/heartsphere?useUnicode=true&characterEncoding=utf8mb4&useSSL=false&serverTimezone=Asia/Shanghai
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver
  # Spring AI Alibaba DashScope配置（使用OpenAPI兼容模式）
  ai:
    dashscope:
      api-key: sk-a486b81e29484fcea112b2c010b7bd95
      base-url: https://dashscope.aliyuncs.com/compatible-mode/v1
      chat:
        options:
          model: qwen-max
          temperature: 0.7
    # 豆包（字节跳动）配置
    doubao:
      api-key: 9ed07a4e-5dad-4cbc-8548-3295e7875b41
      base-url: https://ark.cn-beijing.volces.com/api/v3
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQL8Dialect
        format_sql: true
        use_sql_comments: true
  mvc:
    pathmatch:
      matching-strategy: ANT_PATH_MATCHER
  http:
    encoding:
      charset: UTF-8
      enabled: true
      force: true
  jackson:
    default-property-inclusion: non_null
    serialization:
      write-dates-as-timestamps: false
      write-date-timestamps-as-nanoseconds: false
    mapper:
      accept-case-insensitive-enums: true
    time-zone: Asia/Shanghai
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB
  # CORS 配置
  web:
    cors:
      allowed-origins: '*'
      allowed-methods: GET, POST, PUT, DELETE, OPTIONS
      allowed-headers: '*'
      allow-credentials: true
      exposed-headers: '*'

# JWT 配置
jwt:
  secret: ${JWT_SECRET:your-secret-key-change-in-production}
  expiration: 86400000 # 24小时
  refresh-expiration: 604800000 # 7天

# 微信登录配置（微信开放平台网站应用）
wechat:
  app-id: ${WECHAT_APP_ID:your-wechat-app-id}
  app-secret: ${WECHAT_APP_SECRET:your-wechat-app-secret}
  redirect-uri: ${WECHAT_REDIRECT_URI:http://localhost:8081/api/wechat/callback}

# SpringDoc OpenAPI 配置
springdoc:
  api-docs:
    path: /v3/api-docs
    enabled: true
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    operations-sorter: method
    tags-sorter: alpha
    try-it-out-enabled: true
    doc-expansion: none
    default-models-expand-depth: 1
    default-model-expand-depth: 1
  default-consumes-media-type: application/json
  default-produces-media-type: application/json
  show-actuator: false

# 图片存储配置
app:
  image:
    storage:
      type: ${IMAGE_STORAGE_TYPE:local} # local, oss, s3
      local:
        path: ${IMAGE_STORAGE_PATH:./uploads/images}
      base-url: ${IMAGE_BASE_URL:http://localhost:8081/api/images}  # 注意：端口应与server.port一致，实际访问URL会自动添加 /files/ 前缀
      max-size: ${IMAGE_MAX_SIZE:10485760} # 10MB (单位：字节)

# 日志配置
logging:
  level:
    # 根日志级别
    root: INFO
    # 应用包日志级别
    com.heartsphere: DEBUG
    # Hibernate SQL日志
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
    org.hibernate.type: TRACE
    # Spring Data JPA日志
    org.springframework.data.jpa: DEBUG
    # 数据库连接池日志
    com.zaxxer.hikari: DEBUG
    # Spring Security日志
    org.springframework.security: DEBUG
    # HTTP请求日志
    org.springframework.web: DEBUG
    # SQL语句和参数日志
    org.hibernate.engine.internal: DEBUG
    # AI服务日志
    com.heartsphere.aiagent: DEBUG
    # Spring AI日志
    org.springframework.ai: INFO
    com.alibaba.cloud.ai: INFO
    # Netty DNS日志（用于调试DNS问题）
    io.netty.resolver.dns: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"


