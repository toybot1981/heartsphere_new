# æ¸©åº¦æ„Ÿç³»ç»Ÿç¬¬å››é˜¶æ®µç¬¬äºŒé˜¶æ®µå®Œæˆæ€»ç»“

**å®Œæˆæ—¥æœŸ**: 2025-12-28  
**é˜¶æ®µ**: ç¬¬å››é˜¶æ®µ - ç¬¬äºŒé˜¶æ®µï¼šå¡ç‰‡å’Œå¤šåª’ä½“è¡¨è¾¾

---

## âœ… å·²å®ç°çš„åŠŸèƒ½

### 1. å¡ç‰‡ç³»ç»Ÿç±»å‹å®šä¹‰ (`CardTypes.ts`)

#### æ ¸å¿ƒç±»å‹

- âœ… **CardType** - å¡ç‰‡ç±»å‹æšä¸¾
  - `GREETING` - é—®å€™
  - `BLESSING` - ç¥ç¦
  - `THANKS` - æ„Ÿè°¢
  - `ENCOURAGEMENT` - é¼“åŠ±
  - `CONGRATULATION` - ç¥è´º
  - `SYMPATHY` - æ…°é—®
  - `CUSTOM` - è‡ªå®šä¹‰

- âœ… **Card** - å¡ç‰‡æ¥å£
  - `id` - å”¯ä¸€æ ‡è¯†
  - `userId` - ç”¨æˆ·ID
  - `templateId` - æ¨¡æ¿IDï¼ˆå¯é€‰ï¼‰
  - `type` - å¡ç‰‡ç±»å‹
  - `title` - æ ‡é¢˜
  - `content` - å†…å®¹
  - `background` - èƒŒæ™¯é…ç½®
  - `style` - æ ·å¼é…ç½®
  - `decorations` - è£…é¥°å…ƒç´ 
  - `createdAt` - åˆ›å»ºæ—¶é—´

- âœ… **CardTemplate** - å¡ç‰‡æ¨¡æ¿æ¥å£
- âœ… **CardMessage** - å¡ç‰‡æ¶ˆæ¯æ¥å£
- âœ… **CardBackground** - èƒŒæ™¯é…ç½®æ¥å£
- âœ… **CardStyle** - æ ·å¼é…ç½®æ¥å£
- âœ… **CardLayout** - å¸ƒå±€é…ç½®æ¥å£
- âœ… **CardDecorations** - è£…é¥°é…ç½®æ¥å£

---

### 2. å¡ç‰‡æ¨¡æ¿æ•°æ® (`CardTemplates.ts`)

#### åŠŸèƒ½ç‰¹æ€§

- âœ… **é¢„è®¾æ¨¡æ¿åº“** - åŒ…å«6ä¸ªé¢„è®¾æ¨¡æ¿
  - æ—©å®‰é—®å€™
  - æ™šå®‰é—®å€™
  - é¼“åŠ±å¡ç‰‡
  - æ„Ÿè°¢å¡ç‰‡
  - ç¥ç¦å¡ç‰‡
  - ç¥è´ºå¡ç‰‡

- âœ… **æ¨¡æ¿å·¥å…·å‡½æ•°**
  - `getAllTemplates` - è·å–æ‰€æœ‰æ¨¡æ¿
  - `getTemplatesByType` - æ ¹æ®ç±»å‹è·å–æ¨¡æ¿
  - `getTemplateById` - æ ¹æ®IDè·å–æ¨¡æ¿

---

### 3. å¡ç‰‡å­˜å‚¨ç³»ç»Ÿ (`CardStorage.ts`)

#### åŠŸèƒ½ç‰¹æ€§

- âœ… **å¡ç‰‡å­˜å‚¨** - ä¿å­˜ã€è·å–ã€åˆ é™¤å¡ç‰‡
- âœ… **æ¶ˆæ¯å­˜å‚¨** - ä¿å­˜ã€è·å–å¡ç‰‡æ¶ˆæ¯
- âœ… **å·²è¯»æ ‡è®°** - æ ‡è®°æ¶ˆæ¯ä¸ºå·²è¯»
- âœ… **æœªè¯»ç»Ÿè®¡** - è·å–æœªè¯»æ¶ˆæ¯æ•°é‡
- âœ… **æ•°æ®æŒä¹…åŒ–** - ä½¿ç”¨ localStorage å­˜å‚¨

#### æ ¸å¿ƒæ–¹æ³•

```typescript
class CardStorage {
  saveCard(card): Promise<void>
  getCards(): Card[]
  getCardById(id): Card | undefined
  deleteCard(id): Promise<void>
  saveCardMessage(message): Promise<void>
  getReceivedMessages(recipientId): CardMessage[]
  getSentMessages(senderId): CardMessage[]
  markAsRead(messageId): Promise<void>
  getUnreadCount(recipientId): number
}
```

---

### 4. å¡ç‰‡ç³»ç»Ÿæ ¸å¿ƒç±» (`CardSystem.ts`)

#### åŠŸèƒ½ç‰¹æ€§

- âœ… **æ¨¡æ¿ç®¡ç†** - è·å–ã€æŸ¥è¯¢æ¨¡æ¿
- âœ… **å¡ç‰‡åˆ›å»º** - åˆ›å»ºæ–°å¡ç‰‡
- âœ… **å¡ç‰‡ç®¡ç†** - è·å–ã€åˆ é™¤å¡ç‰‡
- âœ… **æ¶ˆæ¯ç®¡ç†** - è·å–æ”¶åˆ°çš„ã€å‘é€çš„æ¶ˆæ¯
- âœ… **æœªè¯»ç»Ÿè®¡** - è·å–æœªè¯»æ¶ˆæ¯æ•°é‡

#### æ ¸å¿ƒæ–¹æ³•

```typescript
class CardSystem {
  getAllTemplates(): CardTemplate[]
  getTemplatesByType(type): CardTemplate[]
  getTemplateById(id): CardTemplate | undefined
  createCard(cardData): Promise<Card>
  getUserCards(): Card[]
  getCardById(id): Card | undefined
  deleteCard(id): Promise<void>
  getReceivedMessages(): CardMessage[]
  getSentMessages(): CardMessage[]
  getUnreadCount(): number
}
```

---

### 5. React Hook (`useCardSystem.ts`)

#### åŠŸèƒ½ç‰¹æ€§

- âœ… **ç³»ç»Ÿåˆå§‹åŒ–** - è‡ªåŠ¨åˆå§‹åŒ–å¡ç‰‡ç³»ç»Ÿ
- âœ… **çŠ¶æ€ç®¡ç†** - ç®¡ç†ç³»ç»ŸçŠ¶æ€å’Œå°±ç»ªçŠ¶æ€
- âœ… **æ–¹æ³•å°è£…** - å°è£…æ‰€æœ‰å¡ç‰‡ç³»ç»Ÿæ–¹æ³•

---

### 6. å¡ç‰‡ç»„ä»¶

#### 6.1 å¡ç‰‡é¢„è§ˆç»„ä»¶ (`CardPreview.tsx`)

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… æ¸²æŸ“å¡ç‰‡å†…å®¹
- âœ… æ”¯æŒé¢œè‰²ã€å›¾ç‰‡ã€æ¸å˜èƒŒæ™¯
- âœ… æ”¯æŒæ ‡é¢˜å’Œå†…å®¹æ ·å¼
- âœ… æ”¯æŒè£…é¥°è¡¨æƒ…æ˜¾ç¤º
- âœ… å“åº”å¼å¸ƒå±€

#### 6.2 å¡ç‰‡ç¼–è¾‘å™¨ç»„ä»¶ (`CardEditor.tsx`)

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… æ ‡é¢˜å’Œå†…å®¹ç¼–è¾‘
- âœ… èƒŒæ™¯é¢œè‰²é€‰æ‹©
- âœ… å­—ä½“ã€é¢œè‰²ã€å¤§å°è®¾ç½®
- âœ… è£…é¥°è¡¨æƒ…æ·»åŠ 
- âœ… å®æ—¶é¢„è§ˆ

#### 6.3 å¡ç‰‡åˆ¶ä½œå·¥å…· (`CardMaker.tsx`)

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… **æ¨¡æ¿é€‰æ‹©** - ä»é¢„è®¾æ¨¡æ¿ä¸­é€‰æ‹©
- âœ… **è‡ªå®šä¹‰æ¨¡å¼** - ä»ç©ºç™½å¼€å§‹åˆ›å»º
- âœ… **ç¼–è¾‘/é¢„è§ˆåˆ‡æ¢** - å®æ—¶åˆ‡æ¢ç¼–è¾‘å’Œé¢„è§ˆæ¨¡å¼
- âœ… **æ ·å¼è®¾ç½®** - å®Œæ•´çš„æ ·å¼é…ç½®
- âœ… **ä¿å­˜/å‘é€** - ä¿å­˜å¡ç‰‡æˆ–å‘é€ç»™ä»–äºº
- âœ… **ç¾è§‚UI** - ä¸‰æ å¸ƒå±€è®¾è®¡

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
frontend/services/card-system/
â”œâ”€â”€ types/
â”‚   â””â”€â”€ CardTypes.ts            âœ… ç±»å‹å®šä¹‰
â”œâ”€â”€ data/
â”‚   â””â”€â”€ CardTemplates.ts        âœ… æ¨¡æ¿æ•°æ®ï¼ˆ6ä¸ªæ¨¡æ¿ï¼‰
â”œâ”€â”€ storage/
â”‚   â””â”€â”€ CardStorage.ts          âœ… å­˜å‚¨ç³»ç»Ÿ
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useCardSystem.ts        âœ… React Hook
â”œâ”€â”€ CardSystem.ts               âœ… æ ¸å¿ƒç³»ç»Ÿç±»
â””â”€â”€ index.ts                    âœ… å…¥å£æ–‡ä»¶

frontend/components/card/
â”œâ”€â”€ CardMaker.tsx               âœ… å¡ç‰‡åˆ¶ä½œå·¥å…·
â”œâ”€â”€ CardPreview.tsx            âœ… å¡ç‰‡é¢„è§ˆç»„ä»¶
â”œâ”€â”€ CardEditor.tsx             âœ… å¡ç‰‡ç¼–è¾‘å™¨ç»„ä»¶
â””â”€â”€ index.ts                   âœ… å…¥å£æ–‡ä»¶
```

---

## ğŸ¨ è®¾è®¡ç‰¹ç‚¹

### å¡ç‰‡åˆ¶ä½œå·¥å…·ç•Œé¢

- **ä¸‰æ å¸ƒå±€**:
  - å·¦ä¾§ï¼šæ¨¡æ¿é€‰æ‹©/è‡ªå®šä¹‰æ¨¡å¼
  - ä¸­é—´ï¼šç¼–è¾‘/é¢„è§ˆåŒºåŸŸ
  - åº•éƒ¨ï¼šæ“ä½œæŒ‰é’®

- **åŠŸèƒ½å®Œæ•´**:
  - æ¨¡æ¿åº”ç”¨
  - å®æ—¶ç¼–è¾‘
  - å®æ—¶é¢„è§ˆ
  - æ ·å¼é…ç½®
  - è£…é¥°æ·»åŠ 

### å¡ç‰‡é¢„è§ˆ

- **èƒŒæ™¯æ”¯æŒ**:
  - çº¯è‰²èƒŒæ™¯
  - å›¾ç‰‡èƒŒæ™¯
  - æ¸å˜èƒŒæ™¯

- **æ ·å¼æ”¯æŒ**:
  - è‡ªå®šä¹‰å­—ä½“
  - è‡ªå®šä¹‰é¢œè‰²
  - è‡ªå®šä¹‰å¤§å°
  - è‡ªå®šä¹‰å¸ƒå±€

---

## ğŸ”§ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ä½¿ç”¨

```tsx
import { CardMaker } from './components/card';
import { useCardSystem } from './services/card-system';

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
const cardSystem = useCardSystem({
  enabled: true,
  userId: 1,
});

// æ˜¾ç¤ºå¡ç‰‡åˆ¶ä½œå·¥å…·
<CardMaker
  userId={1}
  onSave={(card) => {
    console.log('ä¿å­˜çš„å¡ç‰‡:', card);
  }}
  onSend={(card, recipientId) => {
    console.log('å‘é€å¡ç‰‡:', card, 'ç»™ç”¨æˆ·:', recipientId);
  }}
  onClose={() => setShowCardMaker(false)}
/>
```

### ä½¿ç”¨æ¨¡æ¿

```tsx
<CardMaker
  userId={1}
  templateId="greeting-001"
  onSave={(card) => {
    // ä¿å­˜å¡ç‰‡
  }}
  onClose={() => setShowCardMaker(false)}
/>
```

---

## ğŸ“Š æ¨¡æ¿åº“

### é¢„è®¾æ¨¡æ¿ï¼ˆ6ä¸ªï¼‰

1. **æ—©å®‰é—®å€™** - ç²‰è‰²æ¸å˜èƒŒæ™¯
2. **æ™šå®‰é—®å€™** - è“è‰²æ¸å˜èƒŒæ™¯
3. **é¼“åŠ±å¡ç‰‡** - é»„è‰²èƒŒæ™¯
4. **æ„Ÿè°¢å¡ç‰‡** - ç´«è‰²æ¸å˜èƒŒæ™¯
5. **ç¥ç¦å¡ç‰‡** - ç»¿è‰²æ¸å˜èƒŒæ™¯
6. **ç¥è´ºå¡ç‰‡** - æ©™è‰²æ¸å˜èƒŒæ™¯

---

## ğŸ”„ ä¸‹ä¸€æ­¥ï¼šé›†æˆåˆ°å¯¹è¯å’Œç•™è¨€

### éœ€è¦å®Œæˆçš„å·¥ä½œ

1. **é›†æˆåˆ° ChatWindow**
   - åœ¨è¾“å…¥æ¡†æ·»åŠ å¡ç‰‡æŒ‰é’®
   - ç‚¹å‡»æŒ‰é’®æ‰“å¼€å¡ç‰‡åˆ¶ä½œå·¥å…·
   - åˆ¶ä½œå®Œæˆåå‘é€å¡ç‰‡

2. **é›†æˆåˆ°ç•™è¨€ç³»ç»Ÿ**
   - åœ¨ç•™è¨€åŠŸèƒ½ä¸­æ·»åŠ å¡ç‰‡æ”¯æŒ
   - æ”¯æŒå‘é€å¡ç‰‡ç•™è¨€

3. **å¡ç‰‡æ¶ˆæ¯æ˜¾ç¤º**
   - åœ¨æ¶ˆæ¯ä¸­æ­£ç¡®æ˜¾ç¤ºå¡ç‰‡
   - æ”¯æŒå¡ç‰‡äº¤äº’ï¼ˆæŸ¥çœ‹ã€å›å¤ç­‰ï¼‰

---

## ğŸ“Š æ•°æ®å­˜å‚¨

**å½“å‰å®ç°**: ä½¿ç”¨ `localStorage` å­˜å‚¨
- å¡ç‰‡å­˜å‚¨é”®: `user_cards_{userId}`
- æ¶ˆæ¯å­˜å‚¨é”®: `card_messages_{userId}`
- æ•°æ®æ ¼å¼: JSONæ•°ç»„

**æœªæ¥ä¼˜åŒ–**:
- è¿ç§»åˆ°åç«¯æ•°æ®åº“
- æ”¯æŒæ•°æ®åŒæ­¥
- æ”¯æŒè·¨è®¾å¤‡åŒæ­¥

---

## ğŸ¯ æ€»ç»“

å·²æˆåŠŸå®ç°å¡ç‰‡ç³»ç»Ÿçš„åŸºç¡€åŠŸèƒ½ï¼š
- âœ… å®Œæ•´çš„ç±»å‹å®šä¹‰
- âœ… é¢„è®¾æ¨¡æ¿åº“ï¼ˆ6ä¸ªæ¨¡æ¿ï¼‰
- âœ… å¡ç‰‡å­˜å‚¨ç³»ç»Ÿ
- âœ… å¡ç‰‡åˆ¶ä½œå·¥å…·
- âœ… å¡ç‰‡é¢„è§ˆç»„ä»¶
- âœ… å¡ç‰‡ç¼–è¾‘å™¨ç»„ä»¶

æ‰€æœ‰ç»„ä»¶å·²é€šè¿‡ç±»å‹æ£€æŸ¥ï¼Œå¯ä»¥å¼€å§‹é›†æˆåˆ°å¯¹è¯å’Œç•™è¨€ç³»ç»Ÿä¸­ã€‚

---

**å®Œæˆäºº**: AIåŠ©æ‰‹  
**å®Œæˆæ—¶é—´**: 2025-12-28

