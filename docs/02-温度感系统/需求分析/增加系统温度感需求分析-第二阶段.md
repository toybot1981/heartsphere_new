# å¢åŠ ç³»ç»Ÿæ¸©åº¦æ„Ÿéœ€æ±‚åˆ†ææ–‡æ¡£ - ç¬¬äºŒé˜¶æ®µ

**æ–‡æ¡£ç‰ˆæœ¬**: V1.0  
**ç¼–å†™æ—¥æœŸ**: 2025-12-22  
**äº§å“å®šä½**: å¿ƒåŸŸ - åˆ©ç”¨AIèƒ½åŠ›ä¸ºç”¨æˆ·æä¾›å¿ƒçµåœæ”¾çš„æ¸¯æ¹¾  
**ç›®æ ‡**: å®ç°æƒ…ç»ªæ„ŸçŸ¥ç³»ç»Ÿå’Œä¸ªæ€§åŒ–è®°å¿†ç³»ç»Ÿï¼Œè®©ç³»ç»Ÿæ›´æ‡‚ç”¨æˆ·ï¼Œæ›´æœ‰æ¸©åº¦

---

## ä¸€ã€éœ€æ±‚æ¦‚è¿°

### 1.1 èƒŒæ™¯

è¦è®©å¿ƒåŸŸæˆä¸ºä¸€ä¸ªçœŸæ­£æœ‰æ¸©åº¦çš„å¿ƒçµæ¸¯æ¹¾ï¼Œç³»ç»Ÿéœ€è¦èƒ½å¤Ÿï¼š
1. **æ„ŸçŸ¥ç”¨æˆ·çš„æƒ…ç»ª**ï¼šç†è§£ç”¨æˆ·å½“å‰çš„æƒ…ç»ªçŠ¶æ€ï¼Œç»™äºˆæ°å½“çš„å›åº”
2. **è®°ä½ç”¨æˆ·çš„æ•…äº‹**ï¼šè®°ä½ç”¨æˆ·çš„é‡è¦æ—¶åˆ»ã€åå¥½ã€ä¹ æƒ¯ï¼Œè®©äº¤äº’æ›´ä¸ªæ€§åŒ–

### 1.2 æ ¸å¿ƒç›®æ ‡

- âœ… **æƒ…ç»ªæ„ŸçŸ¥**ï¼šç³»ç»Ÿèƒ½å¤Ÿæ„ŸçŸ¥å’Œç†è§£ç”¨æˆ·çš„æƒ…ç»ªçŠ¶æ€
- âœ… **æƒ…ç»ªå›åº”**ï¼šæ ¹æ®ç”¨æˆ·æƒ…ç»ªæä¾›æ°å½“çš„å›åº”å’Œæ”¯æŒ
- âœ… **è®°å¿†ç³»ç»Ÿ**ï¼šç³»ç»Ÿè®°ä½ç”¨æˆ·çš„é‡è¦æ—¶åˆ»ã€åå¥½ã€ä¹ æƒ¯
- âœ… **ä¸ªæ€§åŒ–äº¤äº’**ï¼šåŸºäºè®°å¿†æä¾›ä¸ªæ€§åŒ–çš„äº¤äº’ä½“éªŒ
- âœ… **æƒ…æ„Ÿæˆé•¿**ï¼šè®°å½•ç”¨æˆ·çš„æƒ…æ„Ÿæˆé•¿è½¨è¿¹

---

## äºŒã€æƒ…ç»ªæ„ŸçŸ¥ç³»ç»Ÿ

### 2.1 æƒ…ç»ªè¯†åˆ«

#### 2.1.1 æƒ…ç»ªè¯†åˆ«æ–¹å¼

**åŠŸèƒ½æè¿°**: é€šè¿‡å¤šç§æ–¹å¼è¯†åˆ«ç”¨æˆ·çš„æƒ…ç»ªçŠ¶æ€ï¼Œå»ºç«‹å…¨æ–¹ä½çš„æƒ…ç»ªæ„ŸçŸ¥èƒ½åŠ›

**è¯¦ç»†éœ€æ±‚**:

1. **æ–‡æœ¬æƒ…ç»ªè¯†åˆ«**

   **å¯¹è¯åˆ†æ**:
   - **åˆ†ææ—¶æœº**: 
     - æ¯ä¸€æ¡ç”¨æˆ·æ¶ˆæ¯å‘é€åç«‹å³åˆ†æ
     - å¯¹è¯ç»“æŸæ—¶ç»¼åˆåˆ†ææ•´ä¸ªå¯¹è¯çš„æƒ…ç»ª
     - å®šæœŸæ‰¹é‡åˆ†æå†å²å¯¹è¯
   - **åˆ†æå†…å®¹**:
     - æ¶ˆæ¯æ–‡æœ¬å†…å®¹
     - æ¶ˆæ¯é•¿åº¦å’Œå¤æ‚åº¦
     - æ ‡ç‚¹ç¬¦å·ä½¿ç”¨ï¼ˆå¦‚æ„Ÿå¹å·ã€é—®å·ã€çœç•¥å·ï¼‰
     - è¡¨æƒ…ç¬¦å·å’Œè¡¨æƒ…æ–‡å­—ï¼ˆå¦‚"ğŸ˜Š"ã€"å“ˆå“ˆ"ã€"..."ï¼‰
   - **åˆ†ææ·±åº¦**:
     - è¡¨é¢æƒ…ç»ªï¼šç›´æ¥è¡¨è¾¾çš„æƒ…ç»ªï¼ˆå¦‚"æˆ‘å¾ˆå¼€å¿ƒ"ï¼‰
     - éšå«æƒ…ç»ªï¼šéšå«åœ¨æ–‡å­—ä¸­çš„æƒ…ç»ªï¼ˆå¦‚"ä»Šå¤©åˆåŠ ç­äº†..."ï¼‰
     - æƒ…ç»ªå¼ºåº¦ï¼šæƒ…ç»ªçš„å¼ºçƒˆç¨‹åº¦
     - æƒ…ç»ªæ··åˆï¼šå¤šç§æƒ…ç»ªçš„æ··åˆçŠ¶æ€

   **æ—¥è®°åˆ†æ**:
   - **åˆ†ææ—¶æœº**: 
     - æ—¥è®°åˆ›å»ºæ—¶å®æ—¶åˆ†æ
     - æ—¥è®°æ›´æ–°æ—¶é‡æ–°åˆ†æ
     - å®šæœŸåˆ†æå†å²æ—¥è®°
   - **åˆ†æç»´åº¦**:
     - æ•´ä½“æƒ…ç»ªåŸºè°ƒ
     - æƒ…ç»ªå˜åŒ–è½¨è¿¹ï¼ˆå¦‚æœæ˜¯å¤šæ®µæ—¥è®°ï¼‰
     - å…³é”®äº‹ä»¶å’Œæƒ…ç»ªè§¦å‘ç‚¹
     - æƒ…æ„Ÿæ·±åº¦å’Œå¤æ‚åº¦
   - **ç‰¹æ®Šå¤„ç†**:
     - æ—¥è®°é€šå¸¸æ›´è¯¦ç»†ï¼Œæƒ…ç»ªè¡¨è¾¾æ›´æ·±å…¥
     - éœ€è¦è€ƒè™‘æ—¥è®°çš„ç§å¯†æ€§å’Œæ•æ„Ÿæ€§
     - æ—¥è®°ä¸­çš„æƒ…ç»ªå¯èƒ½æ›´çœŸå®

   **å…³é”®è¯è¯†åˆ«ç³»ç»Ÿ**:
   ```typescript
   interface EmotionKeyword {
     keyword: string;
     emotionType: EmotionType;
     intensity: EmotionIntensity;
     weight: number; // å…³é”®è¯æƒé‡ï¼ˆ0-1ï¼‰
     context?: string[]; // ä¸Šä¸‹æ–‡å…³é”®è¯ï¼ˆéœ€è¦åŒæ—¶å‡ºç°æ‰è§¦å‘ï¼‰
   }
   
   const emotionKeywords: EmotionKeyword[] = [
     // ç§¯ææƒ…ç»ªå…³é”®è¯
     { keyword: 'å¼€å¿ƒ', emotionType: EmotionType.HAPPY, intensity: EmotionIntensity.MODERATE, weight: 0.8 },
     { keyword: 'é«˜å…´', emotionType: EmotionType.HAPPY, intensity: EmotionIntensity.MODERATE, weight: 0.8 },
     { keyword: 'å¤ªæ£’äº†', emotionType: EmotionType.EXCITED, intensity: EmotionIntensity.STRONG, weight: 0.9 },
     { keyword: 'å…´å¥‹', emotionType: EmotionType.EXCITED, intensity: EmotionIntensity.STRONG, weight: 0.9 },
     { keyword: 'æ»¡è¶³', emotionType: EmotionType.CONTENT, intensity: EmotionIntensity.MILD, weight: 0.7 },
     { keyword: 'å¹³é™', emotionType: EmotionType.PEACEFUL, intensity: EmotionIntensity.MILD, weight: 0.6 },
     
     // æ¶ˆææƒ…ç»ªå…³é”®è¯
     { keyword: 'éš¾è¿‡', emotionType: EmotionType.SAD, intensity: EmotionIntensity.MODERATE, weight: 0.8 },
     { keyword: 'ä¼¤å¿ƒ', emotionType: EmotionType.SAD, intensity: EmotionIntensity.MODERATE, weight: 0.8 },
     { keyword: 'ç„¦è™‘', emotionType: EmotionType.ANXIOUS, intensity: EmotionIntensity.MODERATE, weight: 0.8 },
     { keyword: 'æ‹…å¿ƒ', emotionType: EmotionType.ANXIOUS, intensity: EmotionIntensity.MILD, weight: 0.7 },
     { keyword: 'ç”Ÿæ°”', emotionType: EmotionType.ANGRY, intensity: EmotionIntensity.STRONG, weight: 0.9 },
     { keyword: 'æ„¤æ€’', emotionType: EmotionType.ANGRY, intensity: EmotionIntensity.STRONG, weight: 0.9 },
     { keyword: 'å­¤ç‹¬', emotionType: EmotionType.LONELY, intensity: EmotionIntensity.MODERATE, weight: 0.8 },
     { keyword: 'ç´¯', emotionType: EmotionType.TIRED, intensity: EmotionIntensity.MILD, weight: 0.6 },
     { keyword: 'ç–²æƒ«', emotionType: EmotionType.TIRED, intensity: EmotionIntensity.MODERATE, weight: 0.7 },
     { keyword: 'è¿·èŒ«', emotionType: EmotionType.CONFUSED, intensity: EmotionIntensity.MODERATE, weight: 0.7 },
     
     // å¤åˆå…³é”®è¯ï¼ˆéœ€è¦ä¸Šä¸‹æ–‡ï¼‰
     { keyword: 'è™½ç„¶...ä½†æ˜¯', emotionType: EmotionType.HOPEFUL, intensity: EmotionIntensity.MILD, weight: 0.6, context: ['è™½ç„¶', 'ä½†æ˜¯'] },
   ];
   ```

   **è¯­ä¹‰åˆ†æAIæ¨¡å‹**:
   ```typescript
   interface EmotionAnalysisRequest {
     text: string;
     context?: {
       conversationHistory?: string[];
       userProfile?: UserProfile;
       timeOfDay?: number; // 0-23
       dayOfWeek?: number; // 0-6
     };
     source: EmotionSource;
   }
   
   interface EmotionAnalysisResponse {
     primaryEmotion: EmotionType;
     secondaryEmotions?: EmotionType[]; // æ¬¡è¦æƒ…ç»ª
     intensity: EmotionIntensity;
     confidence: number; // 0-1
     emotionTags: string[];
     reasoning?: string; // AIåˆ†æç†ç”±ï¼ˆç”¨äºè°ƒè¯•ï¼‰
     keyPhrases: string[]; // å…³é”®çŸ­è¯­
   }
   
   // AIæç¤ºè¯æ¨¡æ¿
   const emotionAnalysisPrompt = (text: string, context?: any) => `
   ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æƒ…ç»ªåˆ†æä¸“å®¶ã€‚è¯·åˆ†æä»¥ä¸‹æ–‡æœ¬çš„æƒ…ç»ªçŠ¶æ€ã€‚
   
   æ–‡æœ¬å†…å®¹ï¼š${text}
   ${context ? `\nä¸Šä¸‹æ–‡ä¿¡æ¯ï¼š${JSON.stringify(context)}` : ''}
   
   è¯·åˆ†æå¹¶è¿”å›JSONæ ¼å¼ç»“æœï¼ŒåŒ…å«ï¼š
   1. primaryEmotion: ä¸»è¦æƒ…ç»ªç±»å‹ï¼ˆhappy/excited/content/peaceful/hopeful/grateful/calm/thoughtful/focused/relaxed/sad/anxious/angry/lonely/tired/confusedï¼‰
   2. secondaryEmotions: æ¬¡è¦æƒ…ç»ªç±»å‹æ•°ç»„ï¼ˆå¯é€‰ï¼‰
   3. intensity: æƒ…ç»ªå¼ºåº¦ï¼ˆmild/moderate/strongï¼‰
   4. confidence: åˆ†æç½®ä¿¡åº¦ï¼ˆ0-1ä¹‹é—´çš„å°æ•°ï¼‰
   5. emotionTags: æƒ…ç»ªæ ‡ç­¾æ•°ç»„ï¼ˆå¦‚["å·¥ä½œå‹åŠ›", "æƒ…æ„Ÿå›°æ‰°"]ï¼‰
   6. keyPhrases: å…³é”®çŸ­è¯­æ•°ç»„ï¼ˆæœ€èƒ½ä½“ç°æƒ…ç»ªçš„çŸ­è¯­ï¼‰
   7. reasoning: åˆ†æç†ç”±ï¼ˆç®€è¦è¯´æ˜ä¸ºä»€ä¹ˆå¾—å‡ºè¿™ä¸ªç»“è®ºï¼‰
   
   æ³¨æ„ï¼š
   - è¦æ·±å…¥ç†è§£æ–‡æœ¬çš„éšå«æƒ…ç»ªï¼Œä¸ä»…ä»…æ˜¯è¡¨é¢æ–‡å­—
   - è€ƒè™‘ä¸Šä¸‹æ–‡çš„æƒ…ç»ªèƒŒæ™¯
   - è¯†åˆ«æƒ…ç»ªçš„æ··åˆçŠ¶æ€
   - è¯„ä¼°æƒ…ç»ªçš„å¼ºåº¦å’ŒçœŸå®æ€§
   `;
   ```

2. **è¡Œä¸ºæƒ…ç»ªè¯†åˆ«**

   **äº¤äº’é¢‘ç‡åˆ†æ**:
   ```typescript
   interface InteractionFrequencyAnalysis {
     period: 'day' | 'week' | 'month';
     currentFrequency: number; // å½“å‰æœŸé—´çš„äº¤äº’æ¬¡æ•°
     averageFrequency: number; // å†å²å¹³å‡äº¤äº’æ¬¡æ•°
     trend: 'increasing' | 'decreasing' | 'stable';
     deviation: number; // åç¦»åº¦ï¼ˆç™¾åˆ†æ¯”ï¼‰
     emotionIndicator?: EmotionType; // æƒ…ç»ªæŒ‡ç¤º
   }
   
   // åˆ†æé€»è¾‘
   function analyzeInteractionFrequency(interactions: Interaction[], period: number): InteractionFrequencyAnalysis {
     const currentCount = interactions.filter(i => isInPeriod(i.timestamp, period)).length;
     const historicalAverage = calculateHistoricalAverage(interactions, period);
     const deviation = ((currentCount - historicalAverage) / historicalAverage) * 100;
     
     let emotionIndicator: EmotionType | undefined;
     if (deviation < -30) {
       // äº¤äº’é¢‘ç‡æ˜æ˜¾ä¸‹é™ï¼Œå¯èƒ½æƒ…ç»ªä½è½æˆ–é‡åˆ°é—®é¢˜
       emotionIndicator = EmotionType.SAD;
     } else if (deviation > 30) {
       // äº¤äº’é¢‘ç‡æ˜æ˜¾ä¸Šå‡ï¼Œå¯èƒ½æƒ…ç»ªç§¯ææˆ–æœ‰éœ€æ±‚
       emotionIndicator = EmotionType.HAPPY;
     }
     
     return {
       period: 'week',
       currentFrequency: currentCount,
       averageFrequency: historicalAverage,
       trend: deviation > 10 ? 'increasing' : deviation < -10 ? 'decreasing' : 'stable',
       deviation,
       emotionIndicator
     };
   }
   ```

   **äº¤äº’æ—¶é•¿åˆ†æ**:
   ```typescript
   interface InteractionDurationAnalysis {
     averageDuration: number; // å¹³å‡äº¤äº’æ—¶é•¿ï¼ˆç§’ï¼‰
     recentAverageDuration: number; // æœ€è¿‘å¹³å‡äº¤äº’æ—¶é•¿
     trend: 'increasing' | 'decreasing' | 'stable';
     emotionIndicator?: EmotionType;
   }
   
   // åˆ†æé€»è¾‘
   function analyzeInteractionDuration(interactions: Interaction[]): InteractionDurationAnalysis {
     const recentInteractions = interactions.slice(0, 10); // æœ€è¿‘10æ¬¡
     const recentAvg = recentInteractions.reduce((sum, i) => sum + i.duration, 0) / recentInteractions.length;
     const historicalAvg = interactions.reduce((sum, i) => sum + i.duration, 0) / interactions.length;
     
     let emotionIndicator: EmotionType | undefined;
     if (recentAvg < historicalAvg * 0.7) {
       // äº¤äº’æ—¶é•¿æ˜æ˜¾ç¼©çŸ­ï¼Œå¯èƒ½æƒ…ç»ªä¸ä½³æˆ–å¤±å»å…´è¶£
       emotionIndicator = EmotionType.SAD;
     } else if (recentAvg > historicalAvg * 1.3) {
       // äº¤äº’æ—¶é•¿æ˜æ˜¾å¢åŠ ï¼Œå¯èƒ½æƒ…ç»ªç§¯ææˆ–æ·±åº¦å‚ä¸
       emotionIndicator = EmotionType.HAPPY;
     }
     
     return {
       averageDuration: historicalAvg,
       recentAverageDuration: recentAvg,
       trend: recentAvg > historicalAvg * 1.1 ? 'increasing' : recentAvg < historicalAvg * 0.9 ? 'decreasing' : 'stable',
       emotionIndicator
     };
   }
   ```

   **æ“ä½œæ¨¡å¼åˆ†æ**:
   ```typescript
   interface OperationPatternAnalysis {
     patternChanges: {
       type: 'action' | 'sequence' | 'timing';
       change: string;
       emotionIndicator?: EmotionType;
     }[];
     overallEmotion: EmotionType | null;
   }
   
   // åˆ†æç”¨æˆ·æ“ä½œæ¨¡å¼çš„å˜åŒ–
   function analyzeOperationPattern(userActions: UserAction[]): OperationPatternAnalysis {
     // åˆ†ææ“ä½œç±»å‹å˜åŒ–
     // åˆ†ææ“ä½œåºåˆ—å˜åŒ–
     // åˆ†ææ“ä½œæ—¶é—´æ¨¡å¼å˜åŒ–
     // æ ¹æ®å˜åŒ–æ¨æ–­æƒ…ç»ª
   }
   ```

   **æ´»è·ƒåº¦åˆ†æ**:
   ```typescript
   interface ActivityAnalysis {
     recentActivity: number; // æœ€è¿‘æ´»è·ƒåº¦ï¼ˆ0-100ï¼‰
     historicalAverage: number; // å†å²å¹³å‡æ´»è·ƒåº¦
     trend: 'increasing' | 'decreasing' | 'stable';
     emotionIndicator?: EmotionType;
     lastActiveTime: number; // æœ€åæ´»è·ƒæ—¶é—´
     daysSinceLastActive: number; // è·ç¦»ä¸Šæ¬¡æ´»è·ƒçš„å¤©æ•°
   }
   ```

3. **æ—¶é—´æƒ…ç»ªè¯†åˆ«**

   **æ—¶é—´æ®µæƒ…ç»ªè¯†åˆ«**:
   ```typescript
   interface TimeBasedEmotionPattern {
     hour: number; // 0-23
     typicalEmotions: EmotionType[];
     emotionWeights: Record<EmotionType, number>; // å„æƒ…ç»ªåœ¨è¯¥æ—¶æ®µçš„å…¸å‹æƒé‡
   }
   
   const timeBasedEmotionPatterns: TimeBasedEmotionPattern[] = [
     {
       hour: 6, // æ—©æ™¨
       typicalEmotions: [EmotionType.PEACEFUL, EmotionType.HOPEFUL, EmotionType.CALM],
       emotionWeights: {
         [EmotionType.PEACEFUL]: 0.4,
         [EmotionType.HOPEFUL]: 0.3,
         [EmotionType.CALM]: 0.3
       }
     },
     {
       hour: 12, // ä¸­åˆ
       typicalEmotions: [EmotionType.HAPPY, EmotionType.CONTENT],
       emotionWeights: {
         [EmotionType.HAPPY]: 0.5,
         [EmotionType.CONTENT]: 0.5
       }
     },
     {
       hour: 18, // å‚æ™š
       typicalEmotions: [EmotionType.RELAXED, EmotionType.CONTENT],
       emotionWeights: {
         [EmotionType.RELAXED]: 0.6,
         [EmotionType.CONTENT]: 0.4
       }
     },
     {
       hour: 22, // æ·±å¤œ
       typicalEmotions: [EmotionType.LONELY, EmotionType.THOUGHTFUL, EmotionType.SAD],
       emotionWeights: {
         [EmotionType.LONELY]: 0.4,
         [EmotionType.THOUGHTFUL]: 0.3,
         [EmotionType.SAD]: 0.3
       }
     }
   ];
   ```

   **å‘¨æœŸæƒ…ç»ªè¯†åˆ«**:
   ```typescript
   interface WeeklyEmotionPattern {
     dayOfWeek: number; // 0-6 (Sunday-Saturday)
     typicalEmotions: EmotionType[];
     emotionWeights: Record<EmotionType, number>;
   }
   
   const weeklyEmotionPatterns: WeeklyEmotionPattern[] = [
     {
       dayOfWeek: 1, // Monday
       typicalEmotions: [EmotionType.ANXIOUS, EmotionType.TIRED],
       emotionWeights: {
         [EmotionType.ANXIOUS]: 0.5,
         [EmotionType.TIRED]: 0.5
       }
     },
     {
       dayOfWeek: 5, // Friday
       typicalEmotions: [EmotionType.HAPPY, EmotionType.EXCITED],
       emotionWeights: {
         [EmotionType.HAPPY]: 0.6,
         [EmotionType.EXCITED]: 0.4
       }
     },
     {
       dayOfWeek: 0, // Sunday
       typicalEmotions: [EmotionType.RELAXED, EmotionType.PEACEFUL],
       emotionWeights: {
         [EmotionType.RELAXED]: 0.5,
         [EmotionType.PEACEFUL]: 0.5
       }
     }
   ];
   ```

   **å­£èŠ‚æ€§æƒ…ç»ªè¯†åˆ«**:
   ```typescript
   interface SeasonalEmotionPattern {
     season: 'spring' | 'summer' | 'autumn' | 'winter';
     typicalEmotions: EmotionType[];
     emotionWeights: Record<EmotionType, number>;
   }
   
   const seasonalEmotionPatterns: SeasonalEmotionPattern[] = [
     {
       season: 'winter',
       typicalEmotions: [EmotionType.SAD, EmotionType.LONELY],
       emotionWeights: {
         [EmotionType.SAD]: 0.5,
         [EmotionType.LONELY]: 0.5
       }
     },
     {
       season: 'spring',
       typicalEmotions: [EmotionType.HAPPY, EmotionType.HOPEFUL],
       emotionWeights: {
         [EmotionType.HAPPY]: 0.6,
         [EmotionType.HOPEFUL]: 0.4
       }
     }
   ];
   ```

4. **å¤šæºèåˆè¯†åˆ«ç³»ç»Ÿ**

   **èåˆç®—æ³•**:
   ```typescript
   interface EmotionFusionConfig {
     sources: {
       source: EmotionSource;
       weight: number; // æƒé‡ï¼ˆ0-1ï¼‰
       confidence: number; // è¯¥æ¥æºçš„ç½®ä¿¡åº¦
     }[];
   }
   
   function fuseEmotionResults(
     results: Array<{ source: EmotionSource; emotion: EmotionAnalysisResponse }>,
     config: EmotionFusionConfig
   ): EmotionAnalysisResponse {
     // 1. åŠ æƒå¹³å‡å„æ¥æºçš„æƒ…ç»ªå¼ºåº¦
     const emotionScores: Record<EmotionType, number> = {} as any;
     
     results.forEach((result, index) => {
       const sourceConfig = config.sources.find(s => s.source === result.source);
       if (!sourceConfig) return;
       
       const weight = sourceConfig.weight * result.emotion.confidence * sourceConfig.confidence;
       const intensityScore = getIntensityScore(result.emotion.intensity);
       
       if (!emotionScores[result.emotion.primaryEmotion]) {
         emotionScores[result.emotion.primaryEmotion] = 0;
       }
       emotionScores[result.emotion.primaryEmotion] += weight * intensityScore;
     });
     
     // 2. é€‰æ‹©å¾—åˆ†æœ€é«˜çš„æƒ…ç»ªä½œä¸ºä¸»è¦æƒ…ç»ª
     const primaryEmotion = Object.entries(emotionScores)
       .sort((a, b) => b[1] - a[1])[0][0] as EmotionType;
     
     // 3. è®¡ç®—ç»¼åˆç½®ä¿¡åº¦
     const overallConfidence = results.reduce((sum, r, i) => {
       const sourceConfig = config.sources.find(s => s.source === r.source);
       return sum + (r.emotion.confidence * (sourceConfig?.weight || 0));
     }, 0);
     
     // 4. ç¡®å®šæƒ…ç»ªå¼ºåº¦
     const averageIntensity = calculateAverageIntensity(results.map(r => r.emotion.intensity));
     
     return {
       primaryEmotion,
       intensity: averageIntensity,
       confidence: overallConfidence,
       emotionTags: mergeTags(results.map(r => r.emotion.emotionTags)),
       keyPhrases: mergePhrases(results.map(r => r.emotion.keyPhrases))
     };
   }
   
   function getIntensityScore(intensity: EmotionIntensity): number {
     switch (intensity) {
       case EmotionIntensity.MILD: return 0.5;
       case EmotionIntensity.MODERATE: return 1.0;
       case EmotionIntensity.STRONG: return 1.5;
       default: return 1.0;
     }
   }
   ```

   **æƒ…ç»ªå˜åŒ–è¶‹åŠ¿è¯†åˆ«**:
   ```typescript
   interface EmotionTrend {
     period: 'hour' | 'day' | 'week' | 'month';
     trend: 'improving' | 'declining' | 'stable' | 'fluctuating';
     changeRate: number; // å˜åŒ–é€Ÿç‡ï¼ˆ-1åˆ°1ï¼‰
     recentEmotions: EmotionRecord[];
     trendDescription: string;
   }
   
   function analyzeEmotionTrend(emotionRecords: EmotionRecord[], period: string): EmotionTrend {
     // å°†æƒ…ç»ªè½¬æ¢ä¸ºæ•°å€¼ï¼ˆç§¯ææƒ…ç»ªä¸ºæ­£ï¼Œæ¶ˆææƒ…ç»ªä¸ºè´Ÿï¼‰
     const emotionValues = emotionRecords.map(r => {
       const baseValue = isPositiveEmotion(r.emotionType) ? 1 : isNegativeEmotion(r.emotionType) ? -1 : 0;
       const intensityMultiplier = r.emotionIntensity === EmotionIntensity.STRONG ? 1.5 :
                                   r.emotionIntensity === EmotionIntensity.MODERATE ? 1.0 : 0.5;
       return baseValue * intensityMultiplier * r.confidence;
     });
     
     // è®¡ç®—è¶‹åŠ¿ï¼ˆä½¿ç”¨çº¿æ€§å›å½’ï¼‰
     const trend = calculateLinearTrend(emotionValues);
     
     // åˆ¤æ–­è¶‹åŠ¿ç±»å‹
     let trendType: EmotionTrend['trend'];
     if (Math.abs(trend.slope) < 0.1) {
       trendType = 'stable';
     } else if (trend.slope > 0) {
       trendType = 'improving';
     } else {
       trendType = 'declining';
     }
     
     // è®¡ç®—å˜åŒ–é€Ÿç‡
     const changeRate = trend.slope;
     
     return {
       period: period as any,
       trend: trendType,
       changeRate,
       recentEmotions: emotionRecords.slice(-10),
       trendDescription: generateTrendDescription(trendType, changeRate)
     };
   }
   ```

#### 2.1.2 æƒ…ç»ªåˆ†ç±»ä½“ç³»

**åŠŸèƒ½æè¿°**: å®šä¹‰æƒ…ç»ªåˆ†ç±»ä½“ç³»

**è¯¦ç»†éœ€æ±‚**:

1. **åŸºç¡€æƒ…ç»ªåˆ†ç±»**
   - **ç§¯ææƒ…ç»ª**ï¼šå¼€å¿ƒã€å…´å¥‹ã€æ»¡è¶³ã€å¹³é™ã€å¸Œæœ›ã€æ„Ÿæ¿€
   - **ä¸­æ€§æƒ…ç»ª**ï¼šå¹³é™ã€æ€è€ƒã€ä¸“æ³¨ã€æ”¾æ¾
   - **æ¶ˆææƒ…ç»ª**ï¼šæ‚²ä¼¤ã€ç„¦è™‘ã€æ„¤æ€’ã€å­¤ç‹¬ã€ç–²æƒ«ã€è¿·èŒ«

2. **æƒ…ç»ªå¼ºåº¦ç­‰çº§**
   - **è½»åº¦**ï¼šæƒ…ç»ªè¾ƒå¼±ï¼Œå½±å“è¾ƒå°
   - **ä¸­åº¦**ï¼šæƒ…ç»ªä¸­ç­‰ï¼Œæœ‰æ˜æ˜¾å½±å“
   - **å¼ºçƒˆ**ï¼šæƒ…ç»ªå¼ºçƒˆï¼Œå½±å“è¾ƒå¤§

3. **å¤åˆæƒ…ç»ª**
   - **å¤æ‚æƒ…ç»ª**ï¼šåŒæ—¶åŒ…å«å¤šç§æƒ…ç»ªï¼ˆå¦‚"ç„¦è™‘ä½†å……æ»¡å¸Œæœ›"ï¼‰
   - **æƒ…ç»ªæ··åˆ**ï¼šè¯†åˆ«æƒ…ç»ªçš„æ··åˆçŠ¶æ€

4. **æƒ…ç»ªæ ‡ç­¾**
   - **æƒ…ç»ªæ ‡ç­¾ç³»ç»Ÿ**ï¼šä¸ºæ¯ç§æƒ…ç»ªå®šä¹‰æ ‡ç­¾
   - **æ ‡ç­¾ç»„åˆ**ï¼šæ”¯æŒå¤šä¸ªæ ‡ç­¾ç»„åˆ
   - **è‡ªå®šä¹‰æ ‡ç­¾**ï¼šç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰æƒ…ç»ªæ ‡ç­¾

#### 2.1.3 æƒ…ç»ªæ•°æ®æ¨¡å‹

```typescript
// æƒ…ç»ªè®°å½•
interface EmotionRecord {
  id: string;
  userId: number;
  emotionType: EmotionType; // æƒ…ç»ªç±»å‹
  emotionIntensity: EmotionIntensity; // æƒ…ç»ªå¼ºåº¦
  emotionTags: string[]; // æƒ…ç»ªæ ‡ç­¾
  confidence: number; // è¯†åˆ«ç½®ä¿¡åº¦ï¼ˆ0-1ï¼‰
  source: EmotionSource; // æƒ…ç»ªæ¥æºï¼ˆå¯¹è¯/æ—¥è®°/è¡Œä¸ºï¼‰
  context: string; // ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆè§¦å‘æƒ…ç»ªçš„å†…å®¹ï¼‰
  timestamp: number; // æ—¶é—´æˆ³
  metadata?: {
    conversationId?: string; // å…³è”çš„å¯¹è¯ID
    journalEntryId?: string; // å…³è”çš„æ—¥è®°ID
    triggerText?: string; // è§¦å‘æƒ…ç»ªçš„æ–‡å­—
  };
}

enum EmotionType {
  // ç§¯ææƒ…ç»ª
  HAPPY = 'happy',
  EXCITED = 'excited',
  CONTENT = 'content',
  PEACEFUL = 'peaceful',
  HOPEFUL = 'hopeful',
  GRATEFUL = 'grateful',
  
  // ä¸­æ€§æƒ…ç»ª
  CALM = 'calm',
  THOUGHTFUL = 'thoughtful',
  FOCUSED = 'focused',
  RELAXED = 'relaxed',
  
  // æ¶ˆææƒ…ç»ª
  SAD = 'sad',
  ANXIOUS = 'anxious',
  ANGRY = 'angry',
  LONELY = 'lonely',
  TIRED = 'tired',
  CONFUSED = 'confused'
}

enum EmotionIntensity {
  MILD = 'mild',      // è½»åº¦
  MODERATE = 'moderate', // ä¸­åº¦
  STRONG = 'strong'   // å¼ºçƒˆ
}

enum EmotionSource {
  CONVERSATION = 'conversation', // å¯¹è¯
  JOURNAL = 'journal',           // æ—¥è®°
  BEHAVIOR = 'behavior',         // è¡Œä¸º
  MANUAL = 'manual'              // æ‰‹åŠ¨æ ‡è®°
}
```

### 2.2 æƒ…ç»ªå­˜å‚¨ä¸åˆ†æ

#### 2.2.1 æƒ…ç»ªæ•°æ®å­˜å‚¨

**åŠŸèƒ½æè¿°**: å­˜å‚¨ç”¨æˆ·çš„æƒ…ç»ªæ•°æ®

**è¯¦ç»†éœ€æ±‚**:

1. **æƒ…ç»ªè®°å½•å­˜å‚¨**
   - **å®æ—¶è®°å½•**ï¼šå®æ—¶è®°å½•ç”¨æˆ·çš„æƒ…ç»ªçŠ¶æ€
   - **æ‰¹é‡å­˜å‚¨**ï¼šæ‰¹é‡å­˜å‚¨æƒ…ç»ªæ•°æ®ï¼Œæé«˜æ•ˆç‡
   - **æ•°æ®å‹ç¼©**ï¼šå¯¹å†å²æƒ…ç»ªæ•°æ®è¿›è¡Œå‹ç¼©å­˜å‚¨

2. **æƒ…ç»ªå†å²**
   - **æƒ…ç»ªæ—¶é—´çº¿**ï¼šä¿å­˜ç”¨æˆ·çš„æƒ…ç»ªæ—¶é—´çº¿
   - **æƒ…ç»ªè¶‹åŠ¿**ï¼šåˆ†ææƒ…ç»ªå˜åŒ–è¶‹åŠ¿
   - **æƒ…ç»ªå‘¨æœŸ**ï¼šè¯†åˆ«æƒ…ç»ªå‘¨æœŸæ¨¡å¼

3. **æƒ…ç»ªç»Ÿè®¡**
   - **æ—¥ç»Ÿè®¡**ï¼šæ¯æ—¥çš„æƒ…ç»ªç»Ÿè®¡
   - **å‘¨ç»Ÿè®¡**ï¼šæ¯å‘¨çš„æƒ…ç»ªç»Ÿè®¡
   - **æœˆç»Ÿè®¡**ï¼šæ¯æœˆçš„æƒ…ç»ªç»Ÿè®¡

#### 2.2.2 æƒ…ç»ªåˆ†æç®—æ³•

**åŠŸèƒ½æè¿°**: åˆ†æç”¨æˆ·çš„æƒ…ç»ªæ¨¡å¼å’Œè¶‹åŠ¿

**è¯¦ç»†éœ€æ±‚**:

1. **æƒ…ç»ªè¶‹åŠ¿åˆ†æ**
   - **è¶‹åŠ¿è¯†åˆ«**ï¼šè¯†åˆ«æƒ…ç»ªä¸Šå‡æˆ–ä¸‹é™è¶‹åŠ¿
   - **æ³¢åŠ¨åˆ†æ**ï¼šåˆ†ææƒ…ç»ªçš„æ³¢åŠ¨æƒ…å†µ
   - **ç¨³å®šæ€§åˆ†æ**ï¼šåˆ†ææƒ…ç»ªçš„ç¨³å®šæ€§

2. **æƒ…ç»ªæ¨¡å¼è¯†åˆ«**
   - **æ—¶é—´æ¨¡å¼**ï¼šè¯†åˆ«æ—¶é—´ç›¸å…³çš„æƒ…ç»ªæ¨¡å¼ï¼ˆå¦‚å‘¨ä¸€ç„¦è™‘ï¼‰
   - **åœºæ™¯æ¨¡å¼**ï¼šè¯†åˆ«åœºæ™¯ç›¸å…³çš„æƒ…ç»ªæ¨¡å¼ï¼ˆå¦‚ä¸æŸä¸ªE-SOULå¯¹è¯æ—¶æ›´å¼€å¿ƒï¼‰
   - **å‘¨æœŸæ¨¡å¼**ï¼šè¯†åˆ«å‘¨æœŸæ€§æƒ…ç»ªæ¨¡å¼

3. **æƒ…ç»ªå…³è”åˆ†æ**
   - **æƒ…ç»ªå…³è”**ï¼šåˆ†æä¸åŒæƒ…ç»ªä¹‹é—´çš„å…³è”
   - **è§¦å‘å› ç´ **ï¼šè¯†åˆ«è§¦å‘ç‰¹å®šæƒ…ç»ªçš„å› ç´ 
   - **å½±å“å› ç´ **ï¼šåˆ†æå½±å“æƒ…ç»ªçš„å› ç´ 

#### 2.2.3 æƒ…ç»ªå¯è§†åŒ–è®¾è®¡

**åŠŸèƒ½æè¿°**: é€šè¿‡ç›´è§‚çš„å¯è§†åŒ–å±•ç¤ºç”¨æˆ·çš„æƒ…ç»ªæ•°æ®ï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£è‡ªå·±çš„æƒ…ç»ªçŠ¶æ€å’Œå˜åŒ–

**è¯¦ç»†éœ€æ±‚**:

1. **æƒ…ç»ªæ—¶é—´çº¿å›¾è¡¨**

   **æŠ˜çº¿å›¾è®¾è®¡**:
   ```typescript
   interface EmotionTimelineChart {
     type: 'line';
     data: {
       date: string; // æ—¥æœŸ
       emotionScore: number; // æƒ…ç»ªåˆ†æ•°ï¼ˆ-1åˆ°1ï¼Œ-1ä¸ºæœ€æ¶ˆæï¼Œ1ä¸ºæœ€ç§¯æï¼‰
       primaryEmotion: EmotionType; // ä¸»è¦æƒ…ç»ª
       intensity: EmotionIntensity; // å¼ºåº¦
     }[];
     options: {
       showTrendLine: boolean; // æ˜¾ç¤ºè¶‹åŠ¿çº¿
       showEmotionMarkers: boolean; // æ˜¾ç¤ºæƒ…ç»ªæ ‡è®°ç‚¹
       smooth: boolean; // å¹³æ»‘æ›²çº¿
       colorMapping: Record<EmotionType, string>; // æƒ…ç»ªé¢œè‰²æ˜ å°„
     };
   }
   
   // æƒ…ç»ªåˆ†æ•°è®¡ç®—
   function calculateEmotionScore(emotion: EmotionType, intensity: EmotionIntensity): number {
     const baseScores: Record<EmotionType, number> = {
       [EmotionType.HAPPY]: 0.8,
       [EmotionType.EXCITED]: 0.9,
       [EmotionType.CONTENT]: 0.6,
       [EmotionType.PEACEFUL]: 0.4,
       [EmotionType.HOPEFUL]: 0.7,
       [EmotionType.GRATEFUL]: 0.7,
       [EmotionType.CALM]: 0.3,
       [EmotionType.THOUGHTFUL]: 0.0,
       [EmotionType.FOCUSED]: 0.1,
       [EmotionType.RELAXED]: 0.4,
       [EmotionType.SAD]: -0.7,
       [EmotionType.ANXIOUS]: -0.6,
       [EmotionType.ANGRY]: -0.8,
       [EmotionType.LONELY]: -0.7,
       [EmotionType.TIRED]: -0.4,
       [EmotionType.CONFUSED]: -0.5
     };
     
     const intensityMultiplier = {
       [EmotionIntensity.MILD]: 0.7,
       [EmotionIntensity.MODERATE]: 1.0,
       [EmotionIntensity.STRONG]: 1.3
     };
     
     return baseScores[emotion] * intensityMultiplier[intensity];
   }
   ```

   **æƒ…ç»ªçƒ­åŠ›å›¾è®¾è®¡**:
   ```typescript
   interface EmotionHeatmap {
     type: 'heatmap';
     data: {
       date: string;
       hour: number; // 0-23
       emotionType: EmotionType;
       intensity: number; // 0-1
     }[];
     colorScale: {
       positive: string[]; // ç§¯ææƒ…ç»ªé¢œè‰²æ¸å˜
       negative: string[]; // æ¶ˆææƒ…ç»ªé¢œè‰²æ¸å˜
       neutral: string; // ä¸­æ€§æƒ…ç»ªé¢œè‰²
     };
   }
   ```

   **æƒ…ç»ªåˆ†å¸ƒå›¾è®¾è®¡**:
   ```typescript
   interface EmotionDistributionChart {
     type: 'pie' | 'bar' | 'radar';
     data: {
       emotion: EmotionType;
       count: number;
       percentage: number;
       color: string;
     }[];
     period: 'week' | 'month' | 'year';
   }
   ```

   **å¯è§†åŒ–ç»„ä»¶è®¾è®¡**:
   - **å›¾è¡¨åº“**: ä½¿ç”¨ Chart.js æˆ– ECharts
   - **å“åº”å¼**: é€‚é…æ¡Œé¢å’Œç§»åŠ¨ç«¯
   - **äº¤äº’**: æ”¯æŒç¼©æ”¾ã€ç­›é€‰ã€è¯¦æƒ…æŸ¥çœ‹
   - **å¯¼å‡º**: æ”¯æŒå¯¼å‡ºä¸ºå›¾ç‰‡

2. **æƒ…ç»ªç»Ÿè®¡å›¾è¡¨**

   **æƒ…ç»ªå æ¯”é¥¼å›¾**:
   ```typescript
   interface EmotionPercentageChart {
     type: 'pie';
     data: Array<{
       emotion: EmotionType;
       count: number;
       percentage: number;
       color: string;
     }>;
     showLabels: boolean;
     showValues: boolean;
   }
   ```

   **æƒ…ç»ªè¶‹åŠ¿å›¾**:
   ```typescript
   interface EmotionTrendChart {
     type: 'line' | 'area';
     data: {
       date: string;
       positiveScore: number; // ç§¯ææƒ…ç»ªå¾—åˆ†
       negativeScore: number; // æ¶ˆææƒ…ç»ªå¾—åˆ†
       neutralScore: number; // ä¸­æ€§æƒ…ç»ªå¾—åˆ†
       overallTrend: 'improving' | 'declining' | 'stable';
     }[];
     period: 'week' | 'month' | 'year';
   }
   ```

   **æƒ…ç»ªå¯¹æ¯”å›¾**:
   ```typescript
   interface EmotionComparisonChart {
     type: 'bar';
     periods: Array<{
       label: string; // "æœ¬å‘¨"ã€"ä¸Šå‘¨"
       emotions: Record<EmotionType, number>;
     }>;
     compareMode: 'same_period' | 'sequential'; // åŒæœŸå¯¹æ¯” vs è¿ç»­å¯¹æ¯”
   }
   ```

3. **æƒ…ç»ªæ—¥å†è®¾è®¡**

   **æ—¥å†å¸ƒå±€**:
   ```
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  2025å¹´12æœˆ                          â”‚
   â”œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¤
   â”‚ æ—¥ â”‚ ä¸€ â”‚ äºŒ â”‚ ä¸‰ â”‚ å›› â”‚ äº” â”‚ å…­ â”‚
   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
   â”‚   â”‚   â”‚ ğŸŸ¢ â”‚ ğŸ”µ â”‚ ğŸŸ¢ â”‚ ğŸŸ¡ â”‚ ğŸ”´ â”‚
   â”‚   â”‚   â”‚å¼€å¿ƒâ”‚å¹³é™â”‚å¼€å¿ƒâ”‚ç„¦è™‘â”‚éš¾è¿‡â”‚
   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
   â”‚ ğŸŸ¢ â”‚ ğŸŸ¢ â”‚ ğŸŸ¡ â”‚ ğŸŸ¢ â”‚ ğŸ”µ â”‚ ğŸŸ¢ â”‚ ğŸŸ¢ â”‚
   â”‚å¼€å¿ƒâ”‚å¼€å¿ƒâ”‚ç„¦è™‘â”‚å¼€å¿ƒâ”‚å¹³é™â”‚å¼€å¿ƒâ”‚å¼€å¿ƒâ”‚
   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
   ...
   ```

   **é¢œè‰²æ˜ å°„è§„èŒƒ**:
   ```typescript
   const emotionColorMap: Record<EmotionType, string> = {
     // ç§¯ææƒ…ç»ª - ç»¿è‰²ç³»
     [EmotionType.HAPPY]: '#4CAF50', // ç»¿è‰²
     [EmotionType.EXCITED]: '#8BC34A', // æµ…ç»¿
     [EmotionType.CONTENT]: '#81C784', // æŸ”ç»¿
     [EmotionType.PEACEFUL]: '#A5D6A7', // æ·¡ç»¿
     [EmotionType.HOPEFUL]: '#66BB6A', // ä¸­ç»¿
     [EmotionType.GRATEFUL]: '#43A047', // æ·±ç»¿
     
     // ä¸­æ€§æƒ…ç»ª - è“è‰²ç³»
     [EmotionType.CALM]: '#2196F3', // è“è‰²
     [EmotionType.THOUGHTFUL]: '#64B5F6', // æµ…è“
     [EmotionType.FOCUSED]: '#42A5F5', // ä¸­è“
     [EmotionType.RELAXED]: '#90CAF9', // æ·¡è“
     
     // æ¶ˆææƒ…ç»ª - çº¢è‰²/æ©™è‰²ç³»
     [EmotionType.SAD]: '#F44336', // çº¢è‰²
     [EmotionType.ANXIOUS]: '#FF9800', // æ©™è‰²
     [EmotionType.ANGRY]: '#E53935', // æ·±çº¢
     [EmotionType.LONELY]: '#EF5350', // æµ…çº¢
     [EmotionType.TIRED]: '#FFB74D', // æµ…æ©™
     [EmotionType.CONFUSED]: '#FFA726' // ä¸­æ©™
   };
   ```

   **æƒ…ç»ªè¯¦æƒ…å¡ç‰‡**:
   ```typescript
   interface EmotionDetailCard {
     date: string;
     primaryEmotion: EmotionType;
     secondaryEmotions?: EmotionType[];
     intensity: EmotionIntensity;
     emotionTags: string[];
     context: string; // è§¦å‘æƒ…ç»ªçš„ä¸Šä¸‹æ–‡
     source: EmotionSource;
     relatedMemories?: string[]; // å…³è”çš„è®°å¿†
   }
   ```

   **æ—¥å†äº¤äº’**:
   - **ç‚¹å‡»æ—¥æœŸ**: æ˜¾ç¤ºè¯¥æ—¥çš„æƒ…ç»ªè¯¦æƒ…
   - **æ‚¬åœæ—¥æœŸ**: æ˜¾ç¤ºç®€è¦ä¿¡æ¯ï¼ˆæƒ…ç»ªç±»å‹ã€å¼ºåº¦ï¼‰
   - **æœˆä»½åˆ‡æ¢**: æ”¯æŒåˆ‡æ¢æœˆä»½æŸ¥çœ‹
   - **ç­›é€‰**: æŒ‰æƒ…ç»ªç±»å‹ç­›é€‰æ˜¾ç¤º
   - **å¯¼å‡º**: å¯¼å‡ºæƒ…ç»ªæ—¥å†ä¸ºå›¾ç‰‡

4. **æƒ…ç»ªå¯è§†åŒ–UIç»„ä»¶**

   **ç»„ä»¶ç»“æ„**:
   ```typescript
   // EmotionDashboard.tsx
   interface EmotionDashboardProps {
     userId: number;
     period: 'week' | 'month' | 'year';
   }
   
   const EmotionDashboard: React.FC<EmotionDashboardProps> = ({
     userId,
     period
   }) => {
     return (
       <div className="emotion-dashboard">
         {/* æƒ…ç»ªæ¦‚è§ˆå¡ç‰‡ */}
         <EmotionOverviewCard />
         
         {/* æƒ…ç»ªæ—¶é—´çº¿å›¾è¡¨ */}
         <EmotionTimelineChart period={period} />
         
         {/* æƒ…ç»ªç»Ÿè®¡å›¾è¡¨ */}
         <EmotionStatisticsChart period={period} />
         
         {/* æƒ…ç»ªæ—¥å† */}
         <EmotionCalendar period={period} />
         
         {/* æƒ…ç»ªè¶‹åŠ¿åˆ†æ */}
         <EmotionTrendAnalysis period={period} />
       </div>
     );
   };
   ```

   **è®¾è®¡é£æ ¼**:
   - **æ¸©æš–è‰²è°ƒ**: ä½¿ç”¨æ¸©æš–çš„é…è‰²æ–¹æ¡ˆ
   - **æŸ”å’Œçº¿æ¡**: ä½¿ç”¨æŸ”å’Œçš„æ›²çº¿å’Œæ¸å˜
   - **å‹å¥½å›¾æ ‡**: ä½¿ç”¨å‹å¥½çš„å›¾æ ‡å’Œè¡¨æƒ…ç¬¦å·
   - **æ¸…æ™°æ ‡æ³¨**: æ¸…æ™°çš„æ–‡å­—è¯´æ˜å’Œæ ‡ç­¾

### 2.3 æƒ…ç»ªå›åº”ç³»ç»Ÿ

#### 2.3.1 æƒ…ç»ªæ„ŸçŸ¥è§¦å‘

**åŠŸèƒ½æè¿°**: åœ¨åˆé€‚çš„æ—¶æœºæ„ŸçŸ¥å’Œå›åº”ç”¨æˆ·çš„æƒ…ç»ª

**è¯¦ç»†éœ€æ±‚**:

1. **è§¦å‘æ—¶æœº**
   - **å¯¹è¯å¼€å§‹**ï¼šå¯¹è¯å¼€å§‹æ—¶æ„ŸçŸ¥ç”¨æˆ·æƒ…ç»ª
   - **å¯¹è¯è¿‡ç¨‹**ï¼šå¯¹è¯è¿‡ç¨‹ä¸­æŒç»­æ„ŸçŸ¥æƒ…ç»ªå˜åŒ–
   - **æ—¥è®°åˆ›å»º**ï¼šåˆ›å»ºæ—¥è®°æ—¶æ„ŸçŸ¥æƒ…ç»ª
   - **å®šæœŸæ£€æµ‹**ï¼šå®šæœŸæ£€æµ‹ç”¨æˆ·æƒ…ç»ªçŠ¶æ€

2. **è§¦å‘æ¡ä»¶**
   - **æƒ…ç»ªå˜åŒ–**ï¼šæ£€æµ‹åˆ°æ˜æ˜¾æƒ…ç»ªå˜åŒ–æ—¶è§¦å‘
   - **æ¶ˆææƒ…ç»ª**ï¼šæ£€æµ‹åˆ°æ¶ˆææƒ…ç»ªæ—¶ä¸»åŠ¨å…³æ€€
   - **é•¿æ—¶é—´æœªäº’åŠ¨**ï¼šé•¿æ—¶é—´æœªäº’åŠ¨æ—¶ä¸»åŠ¨å…³æ€€
   - **ç‰¹å®šäº‹ä»¶**ï¼šç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶è§¦å‘

#### 2.3.2 æƒ…ç»ªå›åº”ç­–ç•¥

**åŠŸèƒ½æè¿°**: æ ¹æ®ç”¨æˆ·æƒ…ç»ªæä¾›æ°å½“çš„å›åº”

**è¯¦ç»†éœ€æ±‚**:

1. **ç§¯ææƒ…ç»ªå›åº”**
   - **å…±åº†**ï¼šä¸ç”¨æˆ·ä¸€èµ·åº†ç¥ï¼Œè¡¨è¾¾å–œæ‚¦
   - **é¼“åŠ±**ï¼šé¼“åŠ±ç”¨æˆ·ç»§ç»­ä¿æŒ
   - **åˆ†äº«**ï¼šåˆ†äº«ç›¸ä¼¼çš„ç§¯æä½“éªŒ
   - **å»¶ä¼¸**ï¼šå¼•å¯¼ç”¨æˆ·å»¶ä¼¸ç§¯æçš„æƒ…ç»ª

2. **ä¸­æ€§æƒ…ç»ªå›åº”**
   - **é™ªä¼´**ï¼šé™é™åœ°é™ªä¼´ç”¨æˆ·
   - **å€¾å¬**ï¼šè®¤çœŸå€¾å¬ç”¨æˆ·
   - **æ”¯æŒ**ï¼šæä¾›æ”¯æŒå’Œç†è§£
   - **å¼•å¯¼**ï¼šé€‚å½“å¼•å¯¼ç”¨æˆ·æ€è€ƒ

3. **æ¶ˆææƒ…ç»ªå›åº”**
   - **å…±æƒ…**ï¼šè¡¨è¾¾ç†è§£å’Œå…±æƒ…
   - **å®‰æ…°**ï¼šæä¾›å®‰æ…°å’Œæ”¯æŒ
   - **ç–å¯¼**ï¼šå¸®åŠ©ç–å¯¼è´Ÿé¢æƒ…ç»ª
   - **å»ºè®®**ï¼šæä¾›ç§¯æçš„å»ºè®®ï¼ˆå¦‚æœåˆé€‚ï¼‰

#### 2.3.3 æƒ…ç»ªå›åº”å†…å®¹ç”Ÿæˆ

**åŠŸèƒ½æè¿°**: ä½¿ç”¨AIç”Ÿæˆä¸ªæ€§åŒ–çš„æƒ…ç»ªå›åº”

**è¯¦ç»†éœ€æ±‚**:

1. **å›åº”æ¨¡æ¿**
   - **æƒ…ç»ªæ¨¡æ¿åº“**ï¼šå»ºç«‹ä¸åŒæƒ…ç»ªå¯¹åº”çš„å›åº”æ¨¡æ¿åº“
   - **ä¸ªæ€§åŒ–æ¨¡æ¿**ï¼šåŸºäºç”¨æˆ·ç‰¹ç‚¹é€‰æ‹©æ¨¡æ¿
   - **æ¨¡æ¿è‡ªå®šä¹‰**ï¼šç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰å›åº”æ¨¡æ¿

2. **AIç”Ÿæˆå›åº”**
   - **ä¸Šä¸‹æ–‡ç†è§£**ï¼šåŸºäºç”¨æˆ·æƒ…ç»ªå’Œä¸Šä¸‹æ–‡ç”Ÿæˆå›åº”
   - **ä¸ªæ€§åŒ–ç”Ÿæˆ**ï¼šç»“åˆç”¨æˆ·åå¥½ç”Ÿæˆä¸ªæ€§åŒ–å›åº”
   - **æƒ…æ„Ÿè¡¨è¾¾**ï¼šå›åº”çš„æƒ…æ„Ÿè¡¨è¾¾ä¸ç”¨æˆ·æƒ…ç»ªåŒ¹é…

3. **å›åº”å®¡æ ¸**ï¼ˆå¯é€‰ï¼‰
   - **å›åº”æ£€æŸ¥**ï¼šæ£€æŸ¥å›åº”æ˜¯å¦åˆé€‚
   - **æ•æ„Ÿè¯è¿‡æ»¤**ï¼šè¿‡æ»¤ä¸åˆé€‚çš„è¯æ±‡
   - **æƒ…æ„ŸåŒ¹é…åº¦**ï¼šç¡®ä¿å›åº”æƒ…æ„Ÿä¸ç”¨æˆ·æƒ…ç»ªåŒ¹é…

#### 2.3.4 æƒ…ç»ªå›åº”ç¤ºä¾‹

**ç§¯ææƒ…ç»ªå›åº”**:
- "å¬åˆ°ä½ è¿™ä¹ˆå¼€å¿ƒï¼Œæˆ‘ä¹Ÿæ„Ÿåˆ°å¾ˆé«˜å…´ï¼âœ¨"
- "èƒ½æ„Ÿå—åˆ°ä½ çš„å¿«ä¹ï¼Œè¿™çœŸæ˜¯ä¸€ä¸ªç¾å¥½çš„æ—¶åˆ»ï¼"
- "ä½ çš„ç§¯ææƒ…ç»ªå¾ˆæœ‰æ„ŸæŸ“åŠ›ï¼Œç»§ç»­ä¿æŒï¼"

**ä¸­æ€§æƒ…ç»ªå›åº”**:
- "æˆ‘åœ¨è¿™é‡Œé™ªç€ä½ ï¼Œéšæ—¶å¯ä»¥å’Œæˆ‘èŠèŠã€‚"
- "èƒ½æ„Ÿå—åˆ°ä½ ç°åœ¨çš„å¹³é™ï¼Œè¿™æ˜¯ä¸€ç§å¾ˆå¥½çš„çŠ¶æ€ã€‚"
- "å¦‚æœä½ æœ‰ä»€ä¹ˆæƒ³è¯´çš„ï¼Œæˆ‘éšæ—¶éƒ½åœ¨ã€‚"

**æ¶ˆææƒ…ç»ªå›åº”**:
- "æˆ‘èƒ½æ„Ÿå—åˆ°ä½ ç°åœ¨çš„éš¾è¿‡ï¼Œè¿™ä¸€å®šä¸å®¹æ˜“ã€‚"
- "ä½ å¹¶ä¸å­¤å•ï¼Œæˆ‘ä¼šä¸€ç›´é™ªåœ¨ä½ èº«è¾¹ã€‚"
- "å¦‚æœæ„¿æ„ï¼Œå¯ä»¥å’Œæˆ‘èŠèŠï¼Œæˆ‘ä¼šè®¤çœŸå€¾å¬ã€‚"

### 2.4 æƒ…ç»ªä¸»åŠ¨å…³æ€€

#### 2.4.1 ä¸»åŠ¨å…³æ€€è§¦å‘

**åŠŸèƒ½æè¿°**: åœ¨åˆé€‚çš„æ—¶å€™ä¸»åŠ¨å…³æ€€ç”¨æˆ·

**è¯¦ç»†éœ€æ±‚**:

1. **è§¦å‘æ¡ä»¶**
   - **é•¿æ—¶é—´æ¶ˆææƒ…ç»ª**ï¼šæŒç»­æ¶ˆææƒ…ç»ªæ—¶ä¸»åŠ¨å…³æ€€
   - **æƒ…ç»ªæ€¥å‰§å˜åŒ–**ï¼šæƒ…ç»ªæ€¥å‰§å˜åŒ–æ—¶ä¸»åŠ¨å…³æ€€
   - **é•¿æ—¶é—´æœªäº’åŠ¨**ï¼šé•¿æ—¶é—´æœªäº’åŠ¨æ—¶ä¸»åŠ¨é—®å€™
   - **ç‰¹æ®Šæ—¥æœŸ**ï¼šç‰¹æ®Šæ—¥æœŸï¼ˆå¦‚ç”Ÿæ—¥ã€çºªå¿µæ—¥ï¼‰æ—¶ä¸»åŠ¨å…³æ€€

2. **å…³æ€€é¢‘ç‡**
   - **é€‚åº¦å…³æ€€**ï¼šä¸è¿‡åº¦æ‰“æ‰°ç”¨æˆ·
   - **å…³æ€€é—´éš”**ï¼šè®¾ç½®åˆç†çš„å…³æ€€é—´éš”
   - **ç”¨æˆ·åå¥½**ï¼šå°Šé‡ç”¨æˆ·çš„åå¥½è®¾ç½®

#### 2.4.2 å…³æ€€æ–¹å¼

**åŠŸèƒ½æè¿°**: å¤šç§æ–¹å¼ä¸»åŠ¨å…³æ€€ç”¨æˆ·

**è¯¦ç»†éœ€æ±‚**:

1. **é—®å€™æ¶ˆæ¯**
   - **å®šæ—¶é—®å€™**ï¼šåœ¨åˆé€‚çš„æ—¶é—´å‘é€é—®å€™
   - **ä¸ªæ€§åŒ–é—®å€™**ï¼šåŸºäºç”¨æˆ·ä¹ æƒ¯å’Œæƒ…ç»ªä¸ªæ€§åŒ–é—®å€™
   - **æ¸©é¦¨è¯è¯­**ï¼šä½¿ç”¨æ¸©é¦¨çš„è¯è¯­

2. **å…³æ€€å»ºè®®**
   - **æƒ…ç»ªå»ºè®®**ï¼šæ ¹æ®æƒ…ç»ªçŠ¶æ€æä¾›å»ºè®®
   - **æ´»åŠ¨å»ºè®®**ï¼šå»ºè®®é€‚åˆçš„æ´»åŠ¨ï¼ˆå¦‚æ”¾æ¾ã€è¿åŠ¨ï¼‰
   - **E-SOULæ¨è**ï¼šæ¨èé€‚åˆå½“å‰æƒ…ç»ªçš„E-SOUL

3. **æé†’å…³æ€€**
   - **ä¼‘æ¯æé†’**ï¼šæé†’ç”¨æˆ·é€‚å½“ä¼‘æ¯
   - **æ­£é¢æé†’**ï¼šæé†’ç”¨æˆ·å…³æ³¨ç§¯æçš„äº‹ç‰©
   - **æ”¯æŒæé†’**ï¼šæé†’ç”¨æˆ·å¯»æ±‚æ”¯æŒï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## ä¸‰ã€ä¸ªæ€§åŒ–è®°å¿†ç³»ç»Ÿ

### 3.1 è®°å¿†åˆ†ç±»ä½“ç³»

#### 3.1.1 è®°å¿†ç±»å‹å®šä¹‰

**åŠŸèƒ½æè¿°**: å®šä¹‰ç³»ç»Ÿéœ€è¦è®°ä½çš„å„ç§ç±»å‹çš„è®°å¿†

**è¯¦ç»†éœ€æ±‚**:

1. **ä¸ªäººä¿¡æ¯è®°å¿†**
   - **åŸºæœ¬ä¿¡æ¯**ï¼šå§“åã€æ˜µç§°ã€å¹´é¾„ã€ç”Ÿæ—¥ç­‰
   - **åå¥½ä¿¡æ¯**ï¼šå–œæ¬¢çš„äº‹ç‰©ã€ä¸å–œæ¬¢çš„é£Ÿç‰©ç­‰
   - **ä¹ æƒ¯ä¿¡æ¯**ï¼šä½œæ¯ä¹ æƒ¯ã€ä½¿ç”¨ä¹ æƒ¯ç­‰
   - **æ€§æ ¼ç‰¹å¾**ï¼šæ€§æ ¼ç‰¹ç‚¹ã€MBTIç±»å‹ç­‰

2. **æƒ…æ„Ÿè®°å¿†**
   - **é‡è¦æ—¶åˆ»**ï¼šç”¨æˆ·çš„ç”Ÿæ—¥ã€çºªå¿µæ—¥ç­‰ç‰¹æ®Šæ—¶åˆ»
   - **æƒ…æ„Ÿç»å†**ï¼šç”¨æˆ·åˆ†äº«çš„æƒ…æ„Ÿç»å†
   - **æƒ…ç»ªæ¨¡å¼**ï¼šç”¨æˆ·çš„æƒ…ç»ªæ¨¡å¼å’Œç‰¹ç‚¹
   - **æƒ…æ„Ÿåå¥½**ï¼šç”¨æˆ·çš„æƒ…æ„Ÿåå¥½å’Œéœ€æ±‚

3. **äº¤äº’è®°å¿†**
   - **å¸¸ç”¨E-SOUL**ï¼šç”¨æˆ·ç»å¸¸äº¤äº’çš„E-SOUL
   - **å¯¹è¯ä¸»é¢˜**ï¼šç”¨æˆ·å¸¸èŠçš„è¯é¢˜
   - **äº¤äº’åå¥½**ï¼šç”¨æˆ·çš„äº¤äº’åå¥½å’Œä¹ æƒ¯
   - **å¯¹è¯é£æ ¼**ï¼šç”¨æˆ·å–œæ¬¢çš„å¯¹è¯é£æ ¼

4. **å†…å®¹è®°å¿†**
   - **åˆ›ä½œå†…å®¹**ï¼šç”¨æˆ·åˆ›å»ºçš„æ—¥è®°ã€å‰§æœ¬ç­‰
   - **å…³æ³¨å†…å®¹**ï¼šç”¨æˆ·å…³æ³¨çš„å†…å®¹å’Œè¯é¢˜
   - **æ”¶è—å†…å®¹**ï¼šç”¨æˆ·æ”¶è—çš„å†…å®¹
   - **åˆ†äº«å†…å®¹**ï¼šç”¨æˆ·åˆ†äº«çš„å†…å®¹

5. **æˆé•¿è®°å¿†**
   - **æˆé•¿è½¨è¿¹**ï¼šç”¨æˆ·çš„æˆé•¿å’Œå˜åŒ–
   - **é‡Œç¨‹ç¢‘äº‹ä»¶**ï¼šé‡è¦çš„é‡Œç¨‹ç¢‘äº‹ä»¶
   - **æˆå°±è®°å½•**ï¼šç”¨æˆ·çš„æˆå°±å’Œè¿›æ­¥
   - **åæ€è®°å½•**ï¼šç”¨æˆ·çš„åæ€å’Œæ€»ç»“

#### 3.1.2 è®°å¿†é‡è¦æ€§åˆ†çº§

**åŠŸèƒ½æè¿°**: å¯¹è®°å¿†è¿›è¡Œé‡è¦æ€§åˆ†çº§ï¼Œä¼˜å…ˆè®°ä½é‡è¦è®°å¿†

**è¯¦ç»†éœ€æ±‚**:

1. **é‡è¦çº§åˆ«**
   - **æ ¸å¿ƒè®°å¿†**ï¼šæœ€é‡è¦çš„è®°å¿†ï¼ˆå¦‚ç”Ÿæ—¥ã€é‡å¤§äº‹ä»¶ï¼‰
   - **é‡è¦è®°å¿†**ï¼šé‡è¦çš„è®°å¿†ï¼ˆå¦‚åå¥½ã€ä¹ æƒ¯ï¼‰
   - **æ™®é€šè®°å¿†**ï¼šæ™®é€šè®°å¿†ï¼ˆå¦‚ä¸€èˆ¬å¯¹è¯å†…å®¹ï¼‰
   - **ä¸´æ—¶è®°å¿†**ï¼šä¸´æ—¶è®°å¿†ï¼ˆå¦‚ä¼šè¯ä¸Šä¸‹æ–‡ï¼‰

2. **é‡è¦æ€§åˆ¤æ–­**
   - **ç”¨æˆ·æ ‡è®°**ï¼šç”¨æˆ·ä¸»åŠ¨æ ‡è®°ä¸ºé‡è¦
   - **é¢‘ç‡åˆ¤æ–­**ï¼šæ ¹æ®ä½¿ç”¨é¢‘ç‡åˆ¤æ–­é‡è¦æ€§
   - **æƒ…æ„Ÿå¼ºåº¦**ï¼šæ ¹æ®æƒ…æ„Ÿå¼ºåº¦åˆ¤æ–­é‡è¦æ€§
   - **æ—¶é—´è¿œè¿‘**ï¼šè€ƒè™‘æ—¶é—´å› ç´ 

3. **è®°å¿†ä¿ç•™ç­–ç•¥**
   - **æ°¸ä¹…ä¿ç•™**ï¼šæ ¸å¿ƒè®°å¿†æ°¸ä¹…ä¿ç•™
   - **é•¿æœŸä¿ç•™**ï¼šé‡è¦è®°å¿†é•¿æœŸä¿ç•™
   - **å®šæœŸæ¸…ç†**ï¼šæ™®é€šè®°å¿†å®šæœŸæ¸…ç†
   - **ä¼šè¯æ¸…ç†**ï¼šä¸´æ—¶è®°å¿†ä¼šè¯ç»“æŸåæ¸…ç†

### 3.2 è®°å¿†æå–ä¸å­˜å‚¨

#### 3.2.1 è®°å¿†æå–

**åŠŸèƒ½æè¿°**: ä»ç”¨æˆ·äº¤äº’ä¸­æå–è®°å¿†

**è¯¦ç»†éœ€æ±‚**:

1. **å¯¹è¯è®°å¿†æå–**
   - **å…³é”®ä¿¡æ¯æå–**ï¼šä»å¯¹è¯ä¸­æå–å…³é”®ä¿¡æ¯
   - **åå¥½æå–**ï¼šæå–ç”¨æˆ·çš„åå¥½ä¿¡æ¯
   - **æƒ…æ„Ÿæå–**ï¼šæå–ç”¨æˆ·çš„æƒ…æ„Ÿä¿¡æ¯
   - **äº‹ä»¶æå–**ï¼šæå–é‡è¦äº‹ä»¶ä¿¡æ¯

2. **æ—¥è®°è®°å¿†æå–**
   - **ä¸»é¢˜æå–**ï¼šæå–æ—¥è®°çš„ä¸»é¢˜
   - **æƒ…æ„Ÿæå–**ï¼šæå–æ—¥è®°ä¸­çš„æƒ…æ„Ÿ
   - **äº‹ä»¶æå–**ï¼šæå–æ—¥è®°ä¸­è®°å½•çš„äº‹ä»¶
   - **åæ€æå–**ï¼šæå–ç”¨æˆ·çš„åæ€å’Œæ„Ÿæ‚Ÿ

3. **è¡Œä¸ºè®°å¿†æå–**
   - **è¡Œä¸ºæ¨¡å¼**ï¼šæå–ç”¨æˆ·çš„è¡Œä¸ºæ¨¡å¼
   - **ä½¿ç”¨ä¹ æƒ¯**ï¼šæå–ç”¨æˆ·çš„ä½¿ç”¨ä¹ æƒ¯
   - **åå¥½æ¨æ–­**ï¼šä»è¡Œä¸ºä¸­æ¨æ–­ç”¨æˆ·åå¥½

4. **AIè¾…åŠ©æå–**
   - **è¯­ä¹‰ç†è§£**ï¼šä½¿ç”¨AIç†è§£è¯­ä¹‰ï¼Œæå–è®°å¿†
   - **ä¿¡æ¯ç»“æ„åŒ–**ï¼šå°†æå–çš„ä¿¡æ¯ç»“æ„åŒ–
   - **é‡è¦æ€§è¯„ä¼°**ï¼šè¯„ä¼°è®°å¿†çš„é‡è¦æ€§

#### 3.2.2 è®°å¿†å­˜å‚¨ç»“æ„

**åŠŸèƒ½æè¿°**: å®šä¹‰è®°å¿†çš„å­˜å‚¨ç»“æ„

**è¯¦ç»†éœ€æ±‚**:

1. **è®°å¿†æ•°æ®ç»“æ„**

```typescript
// ç”¨æˆ·è®°å¿†
interface UserMemory {
  id: string;
  userId: number;
  memoryType: MemoryType; // è®°å¿†ç±»å‹
  importance: MemoryImportance; // é‡è¦æ€§
  content: string; // è®°å¿†å†…å®¹
  structuredData?: {  // ç»“æ„åŒ–æ•°æ®
    key?: string;     // é”®ï¼ˆå¦‚"ç”Ÿæ—¥"ï¼‰
    value?: any;      // å€¼ï¼ˆå¦‚"1990-01-01"ï¼‰
    tags?: string[];  // æ ‡ç­¾
  };
  source: MemorySource; // è®°å¿†æ¥æº
  sourceId?: string;    // æ¥æºIDï¼ˆå¦‚å¯¹è¯IDã€æ—¥è®°IDï¼‰
  timestamp: number;    // æ—¶é—´æˆ³
  lastUsedAt?: number;  // æœ€åä½¿ç”¨æ—¶é—´
  usageCount: number;   // ä½¿ç”¨æ¬¡æ•°
  confidence: number;   // æå–ç½®ä¿¡åº¦ï¼ˆ0-1ï¼‰
  metadata?: {
    emotion?: EmotionType; // å…³è”çš„æƒ…ç»ª
    eraId?: number;        // å…³è”çš„åœºæ™¯ID
    characterId?: string;  // å…³è”çš„è§’è‰²ID
  };
}

enum MemoryType {
  // ä¸ªäººä¿¡æ¯
  PERSONAL_INFO = 'personal_info',
  PREFERENCE = 'preference',
  HABIT = 'habit',
  PERSONALITY = 'personality',
  
  // æƒ…æ„Ÿè®°å¿†
  IMPORTANT_MOMENT = 'important_moment',
  EMOTIONAL_EXPERIENCE = 'emotional_experience',
  EMOTION_PATTERN = 'emotion_pattern',
  EMOTIONAL_PREFERENCE = 'emotional_preference',
  
  // äº¤äº’è®°å¿†
  FREQUENT_CHARACTER = 'frequent_character',
  CONVERSATION_TOPIC = 'conversation_topic',
  INTERACTION_PREFERENCE = 'interaction_preference',
  CONVERSATION_STYLE = 'conversation_style',
  
  // å†…å®¹è®°å¿†
  CREATED_CONTENT = 'created_content',
  FOCUSED_CONTENT = 'focused_content',
  FAVORITED_CONTENT = 'favorited_content',
  SHARED_CONTENT = 'shared_content',
  
  // æˆé•¿è®°å¿†
  GROWTH_TRAJECTORY = 'growth_trajectory',
  MILESTONE = 'milestone',
  ACHIEVEMENT = 'achievement',
  REFLECTION = 'reflection'
}

enum MemoryImportance {
  CORE = 'core',       // æ ¸å¿ƒè®°å¿†
  IMPORTANT = 'important', // é‡è¦è®°å¿†
  NORMAL = 'normal',   // æ™®é€šè®°å¿†
  TEMPORARY = 'temporary' // ä¸´æ—¶è®°å¿†
}

enum MemorySource {
  CONVERSATION = 'conversation', // å¯¹è¯
  JOURNAL = 'journal',           // æ—¥è®°
  BEHAVIOR = 'behavior',         // è¡Œä¸º
  MANUAL = 'manual',             // æ‰‹åŠ¨æ·»åŠ 
  SYSTEM = 'system'              // ç³»ç»Ÿç”Ÿæˆ
}
```

2. **è®°å¿†ç´¢å¼•**
   - **å…³é”®è¯ç´¢å¼•**ï¼šä¸ºè®°å¿†å»ºç«‹å…³é”®è¯ç´¢å¼•
   - **ç±»å‹ç´¢å¼•**ï¼šæŒ‰è®°å¿†ç±»å‹ç´¢å¼•
   - **æ—¶é—´ç´¢å¼•**ï¼šæŒ‰æ—¶é—´ç´¢å¼•
   - **å…³è”ç´¢å¼•**ï¼šæŒ‰å…³è”å…³ç³»ç´¢å¼•

3. **è®°å¿†å…³è”**
   - **å…³è”å…³ç³»**ï¼šå»ºç«‹è®°å¿†ä¹‹é—´çš„å…³è”å…³ç³»
   - **å…³è”ç½‘ç»œ**ï¼šæ„å»ºè®°å¿†å…³è”ç½‘ç»œ
   - **å…³è”æ£€ç´¢**ï¼šæ”¯æŒé€šè¿‡å…³è”æ£€ç´¢è®°å¿†

#### 3.2.3 è®°å¿†æ•°æ®åº“è®¾è®¡

```sql
-- ç”¨æˆ·è®°å¿†è¡¨
CREATE TABLE user_memories (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  user_id BIGINT NOT NULL COMMENT 'ç”¨æˆ·ID',
  memory_type VARCHAR(50) NOT NULL COMMENT 'è®°å¿†ç±»å‹',
  importance VARCHAR(20) NOT NULL DEFAULT 'normal' COMMENT 'é‡è¦æ€§ï¼šcore, important, normal, temporary',
  content TEXT NOT NULL COMMENT 'è®°å¿†å†…å®¹',
  structured_key VARCHAR(200) COMMENT 'ç»“æ„åŒ–é”®ï¼ˆå¦‚"ç”Ÿæ—¥"ï¼‰',
  structured_value TEXT COMMENT 'ç»“æ„åŒ–å€¼ï¼ˆJSONæ ¼å¼ï¼‰',
  tags TEXT COMMENT 'æ ‡ç­¾ï¼ˆJSONæ•°ç»„ï¼‰',
  source VARCHAR(50) NOT NULL COMMENT 'æ¥æºï¼šconversation, journal, behavior, manual, system',
  source_id VARCHAR(100) COMMENT 'æ¥æºID',
  emotion_type VARCHAR(50) COMMENT 'å…³è”çš„æƒ…ç»ªç±»å‹',
  era_id BIGINT COMMENT 'å…³è”çš„åœºæ™¯ID',
  character_id VARCHAR(100) COMMENT 'å…³è”çš„è§’è‰²ID',
  confidence DECIMAL(3,2) DEFAULT 1.0 COMMENT 'æå–ç½®ä¿¡åº¦ï¼ˆ0-1ï¼‰',
  usage_count INT DEFAULT 0 COMMENT 'ä½¿ç”¨æ¬¡æ•°',
  last_used_at DATETIME NULL COMMENT 'æœ€åä½¿ç”¨æ—¶é—´',
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
  INDEX idx_user_type (user_id, memory_type),
  INDEX idx_user_importance (user_id, importance),
  INDEX idx_user_used (user_id, last_used_at DESC),
  INDEX idx_source (source, source_id),
  FULLTEXT INDEX idx_content (content)
);

-- è®°å¿†å…³è”è¡¨
CREATE TABLE memory_relations (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  memory_id_1 BIGINT NOT NULL COMMENT 'è®°å¿†1 ID',
  memory_id_2 BIGINT NOT NULL COMMENT 'è®°å¿†2 ID',
  relation_type VARCHAR(50) NOT NULL COMMENT 'å…³è”ç±»å‹ï¼šrelated, similar, opposite, sequential',
  strength DECIMAL(3,2) DEFAULT 0.5 COMMENT 'å…³è”å¼ºåº¦ï¼ˆ0-1ï¼‰',
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (memory_id_1) REFERENCES user_memories(id) ON DELETE CASCADE,
  FOREIGN KEY (memory_id_2) REFERENCES user_memories(id) ON DELETE CASCADE,
  INDEX idx_memory_1 (memory_id_1),
  INDEX idx_memory_2 (memory_id_2)
);

-- è®°å¿†ä½¿ç”¨è®°å½•è¡¨
CREATE TABLE memory_usage_logs (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  memory_id BIGINT NOT NULL COMMENT 'è®°å¿†ID',
  usage_context VARCHAR(100) COMMENT 'ä½¿ç”¨åœºæ™¯ï¼šconversation, response, recommendation',
  usage_timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (memory_id) REFERENCES user_memories(id) ON DELETE CASCADE,
  INDEX idx_memory_time (memory_id, usage_timestamp)
);
```

### 3.3 è®°å¿†æ£€ç´¢ä¸åº”ç”¨

#### 3.3.1 è®°å¿†æ£€ç´¢

**åŠŸèƒ½æè¿°**: åœ¨éœ€è¦æ—¶æ£€ç´¢ç›¸å…³è®°å¿†

**è¯¦ç»†éœ€æ±‚**:

1. **æ£€ç´¢åœºæ™¯**
   - **å¯¹è¯å¼€å§‹**ï¼šå¯¹è¯å¼€å§‹æ—¶æ£€ç´¢ç›¸å…³è®°å¿†
   - **å¯¹è¯è¿‡ç¨‹**ï¼šå¯¹è¯è¿‡ç¨‹ä¸­æ£€ç´¢ç›¸å…³è®°å¿†
   - **å†…å®¹ç”Ÿæˆ**ï¼šç”Ÿæˆå†…å®¹æ—¶æ£€ç´¢ç›¸å…³è®°å¿†
   - **æ¨èç”Ÿæˆ**ï¼šç”Ÿæˆæ¨èæ—¶æ£€ç´¢ç›¸å…³è®°å¿†

2. **æ£€ç´¢æ–¹å¼**
   - **å…³é”®è¯æ£€ç´¢**ï¼šé€šè¿‡å…³é”®è¯æ£€ç´¢è®°å¿†
   - **è¯­ä¹‰æ£€ç´¢**ï¼šé€šè¿‡è¯­ä¹‰æ£€ç´¢è®°å¿†
   - **å…³è”æ£€ç´¢**ï¼šé€šè¿‡å…³è”å…³ç³»æ£€ç´¢è®°å¿†
   - **æ—¶é—´æ£€ç´¢**ï¼šé€šè¿‡æ—¶é—´æ£€ç´¢è®°å¿†

3. **æ£€ç´¢æ’åº**
   - **é‡è¦æ€§æ’åº**ï¼šæŒ‰é‡è¦æ€§æ’åº
   - **ç›¸å…³æ€§æ’åº**ï¼šæŒ‰ç›¸å…³æ€§æ’åº
   - **ä½¿ç”¨é¢‘ç‡æ’åº**ï¼šæŒ‰ä½¿ç”¨é¢‘ç‡æ’åº
   - **æ—¶é—´æ’åº**ï¼šæŒ‰æ—¶é—´æ’åº

#### 3.3.2 è®°å¿†åº”ç”¨

**åŠŸèƒ½æè¿°**: å°†æ£€ç´¢åˆ°çš„è®°å¿†åº”ç”¨åˆ°äº¤äº’ä¸­

**è¯¦ç»†éœ€æ±‚**:

1. **ä¸ªæ€§åŒ–ç§°å‘¼**
   - **å§“åä½¿ç”¨**ï¼šåœ¨å¯¹è¯ä¸­ä½¿ç”¨ç”¨æˆ·çš„å§“å
   - **æ˜µç§°ä½¿ç”¨**ï¼šä½¿ç”¨ç”¨æˆ·å–œæ¬¢çš„æ˜µç§°
   - **ç§°å‘¼å˜åŒ–**ï¼šæ ¹æ®å…³ç³»å˜åŒ–ä½¿ç”¨ä¸åŒç§°å‘¼

2. **ä¸ªæ€§åŒ–å†…å®¹**
   - **è¯é¢˜å…³è”**ï¼šå…³è”ç”¨æˆ·å…³å¿ƒçš„è¯é¢˜
   - **åå¥½è€ƒè™‘**ï¼šè€ƒè™‘ç”¨æˆ·çš„åå¥½
   - **ä¹ æƒ¯å°Šé‡**ï¼šå°Šé‡ç”¨æˆ·çš„ä½¿ç”¨ä¹ æƒ¯

3. **æƒ…æ„Ÿå…³è”**
   - **æƒ…æ„Ÿå…±é¸£**ï¼šå…³è”ç”¨æˆ·çš„æƒ…æ„Ÿç»å†
   - **é‡è¦æ—¶åˆ»**ï¼šæåŠç”¨æˆ·çš„é‡è¦æ—¶åˆ»
   - **æˆé•¿è§è¯**ï¼šè§è¯ç”¨æˆ·çš„æˆé•¿

4. **è®°å¿†å¼•ç”¨**
   - **è‡ªç„¶å¼•ç”¨**ï¼šè‡ªç„¶åœ°å¼•ç”¨ç”¨æˆ·ä¹‹å‰çš„å¯¹è¯
   - **è®°å¿†æé†’**ï¼šæé†’ç”¨æˆ·ä¹‹å‰çš„è®°å¿†
   - **å¯¹æ¯”å˜åŒ–**ï¼šå¯¹æ¯”ç°åœ¨å’Œè¿‡å»çš„å˜åŒ–

#### 3.3.3 è®°å¿†æ›´æ–°

**åŠŸèƒ½æè¿°**: æŒç»­æ›´æ–°å’Œå®Œå–„è®°å¿†

**è¯¦ç»†éœ€æ±‚**:

1. **è®°å¿†ä¿®æ­£**
   - **ç”¨æˆ·çº æ­£**ï¼šç”¨æˆ·çº æ­£é”™è¯¯çš„è®°å¿†
   - **è‡ªåŠ¨æ›´æ–°**ï¼šè‡ªåŠ¨æ›´æ–°å˜åŒ–çš„è®°å¿†
   - **è®°å¿†åˆå¹¶**ï¼šåˆå¹¶é‡å¤æˆ–ç›¸ä¼¼çš„è®°å¿†

2. **è®°å¿†å¼ºåŒ–**
   - **ä½¿ç”¨å¼ºåŒ–**ï¼šé¢‘ç¹ä½¿ç”¨çš„è®°å¿†å¾—åˆ°å¼ºåŒ–
   - **é‡è¦æ€§æå‡**ï¼šé‡è¦è®°å¿†çš„é‡è¦æ€§æå‡
   - **å…³è”åŠ å¼º**ï¼šåŠ å¼ºè®°å¿†ä¹‹é—´çš„å…³è”

3. **è®°å¿†æ¸…ç†**
   - **è¿‡æœŸæ¸…ç†**ï¼šæ¸…ç†è¿‡æœŸçš„ä¸´æ—¶è®°å¿†
   - **ä½ä»·å€¼æ¸…ç†**ï¼šæ¸…ç†ä½ä»·å€¼çš„è®°å¿†
   - **é‡å¤æ¸…ç†**ï¼šæ¸…ç†é‡å¤çš„è®°å¿†

### 3.4 è®°å¿†å±•ç¤ºä¸ç®¡ç†

#### 3.4.1 è®°å¿†å±•ç¤º

**åŠŸèƒ½æè¿°**: å‘ç”¨æˆ·å±•ç¤ºç³»ç»Ÿè®°ä½çš„å†…å®¹

**è¯¦ç»†éœ€æ±‚**:

1. **è®°å¿†åˆ—è¡¨**
   - **è®°å¿†å…¥å£**ï¼šåœ¨ä¸ªäººä¸­å¿ƒæ·»åŠ "æˆ‘çš„è®°å¿†"å…¥å£
   - **è®°å¿†åˆ†ç±»**ï¼šæŒ‰ç±»å‹åˆ†ç±»å±•ç¤ºè®°å¿†
   - **è®°å¿†æœç´¢**ï¼šæ”¯æŒæœç´¢è®°å¿†

2. **è®°å¿†è¯¦æƒ…**
   - **è¯¦æƒ…æŸ¥çœ‹**ï¼šç‚¹å‡»æŸ¥çœ‹è®°å¿†è¯¦æƒ…
   - **è®°å¿†æ¥æº**ï¼šæ˜¾ç¤ºè®°å¿†çš„æ¥æº
   - **è®°å¿†æ—¶é—´çº¿**ï¼šæ˜¾ç¤ºè®°å¿†çš„æ—¶é—´çº¿

3. **è®°å¿†å¯è§†åŒ–**
   - **è®°å¿†åœ°å›¾**ï¼šå¯è§†åŒ–å±•ç¤ºè®°å¿†ä¹‹é—´çš„å…³ç³»
   - **è®°å¿†æ—¶é—´çº¿**ï¼šæ—¶é—´çº¿å±•ç¤ºè®°å¿†
   - **è®°å¿†ç»Ÿè®¡**ï¼šç»Ÿè®¡å„ç§ç±»å‹çš„è®°å¿†

#### 3.4.2 è®°å¿†ç®¡ç†

**åŠŸèƒ½æè¿°**: ç”¨æˆ·ç®¡ç†è‡ªå·±çš„è®°å¿†

**è¯¦ç»†éœ€æ±‚**:

1. **è®°å¿†ç¼–è¾‘**
   - **å†…å®¹ç¼–è¾‘**ï¼šç¼–è¾‘è®°å¿†å†…å®¹
   - **é‡è¦æ€§è°ƒæ•´**ï¼šè°ƒæ•´è®°å¿†é‡è¦æ€§
   - **æ ‡ç­¾ç®¡ç†**ï¼šç®¡ç†è®°å¿†æ ‡ç­¾

2. **è®°å¿†åˆ é™¤**
   - **å•æ¡åˆ é™¤**ï¼šåˆ é™¤å•æ¡è®°å¿†
   - **æ‰¹é‡åˆ é™¤**ï¼šæ‰¹é‡åˆ é™¤è®°å¿†
   - **åˆ é™¤ç¡®è®¤**ï¼šåˆ é™¤å‰ç¡®è®¤

3. **è®°å¿†æ·»åŠ **
   - **æ‰‹åŠ¨æ·»åŠ **ï¼šæ‰‹åŠ¨æ·»åŠ è®°å¿†
   - **è®°å¿†å¯¼å…¥**ï¼šå¯¼å…¥è®°å¿†ï¼ˆå¦‚æœæ”¯æŒï¼‰
   - **è®°å¿†åˆ†äº«**ï¼šåˆ†äº«è®°å¿†ï¼ˆå¦‚æœæ”¯æŒï¼‰

---

## å››ã€æƒ…ç»ªä¸è®°å¿†çš„èåˆ

### 4.1 æƒ…ç»ªè®°å¿†å…³è”

**åŠŸèƒ½æè¿°**: å°†æƒ…ç»ªä¸è®°å¿†å…³è”ï¼Œå½¢æˆæ›´å®Œæ•´çš„ç”¨æˆ·ç”»åƒ

**è¯¦ç»†éœ€æ±‚**:

1. **æƒ…ç»ªè®°å¿†ç»‘å®š**
   - **æƒ…ç»ªè®°å½•å…³è”è®°å¿†**ï¼šè®°å½•æƒ…ç»ªæ—¶å…³è”ç›¸å…³è®°å¿†
   - **è®°å¿†è§¦å‘æƒ…ç»ª**ï¼šæŸäº›è®°å¿†å¯èƒ½è§¦å‘ç‰¹å®šæƒ…ç»ª
   - **æƒ…ç»ªè®°å¿†ç½‘ç»œ**ï¼šæ„å»ºæƒ…ç»ªå’Œè®°å¿†çš„å…³è”ç½‘ç»œ

2. **æƒ…ç»ªæ¨¡å¼è®°å¿†**
   - **æƒ…ç»ªæ¨¡å¼è®°å½•**ï¼šè®°å½•ç”¨æˆ·çš„æƒ…ç»ªæ¨¡å¼
   - **æƒ…ç»ªè§¦å‘å› ç´ **ï¼šè®°å½•è§¦å‘æƒ…ç»ªçš„å› ç´ 
   - **æƒ…ç»ªåº”å¯¹æ–¹å¼**ï¼šè®°å½•ç”¨æˆ·åº”å¯¹æƒ…ç»ªçš„æ–¹å¼

### 4.2 ä¸ªæ€§åŒ–äº¤äº’å¢å¼º

**åŠŸèƒ½æè¿°**: åŸºäºæƒ…ç»ªå’Œè®°å¿†æä¾›æ›´ä¸ªæ€§åŒ–çš„äº¤äº’

**è¯¦ç»†éœ€æ±‚**:

1. **æƒ…ç»ªæ„ŸçŸ¥äº¤äº’**
   - **æƒ…ç»ªæ„ŸçŸ¥å›åº”**ï¼šåŸºäºå½“å‰æƒ…ç»ªæä¾›å›åº”
   - **è®°å¿†å…³è”å›åº”**ï¼šå…³è”ç›¸å…³è®°å¿†æä¾›å›åº”
   - **ä¸ªæ€§åŒ–å»ºè®®**ï¼šåŸºäºæƒ…ç»ªå’Œè®°å¿†æä¾›å»ºè®®

2. **è®°å¿†è§¦å‘äº¤äº’**
   - **è®°å¿†æåŠ**ï¼šåœ¨åˆé€‚çš„æ—¶å€™æåŠç›¸å…³è®°å¿†
   - **è®°å¿†å¯¹æ¯”**ï¼šå¯¹æ¯”è¿‡å»å’Œç°åœ¨
   - **è®°å¿†æˆé•¿**ï¼šè§è¯è®°å¿†çš„æˆé•¿å’Œå˜åŒ–

---

## äº”ã€æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### 5.1 AIæƒ…ç»ªè¯†åˆ«

#### 5.1.1 æ–‡æœ¬æƒ…ç»ªè¯†åˆ«

**å®ç°æ–¹å¼**:
```python
# ä¼ªä»£ç ç¤ºä¾‹
def analyze_emotion_from_text(text: str, context: dict) -> EmotionRecord:
    # ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹åˆ†ææ–‡æœ¬æƒ…ç»ª
    prompt = f"""
    åˆ†æä»¥ä¸‹æ–‡æœ¬çš„æƒ…ç»ªï¼š
    æ–‡æœ¬ï¼š{text}
    ä¸Šä¸‹æ–‡ï¼š{context}
    
    è¯·è¯†åˆ«ï¼š
    1. æƒ…ç»ªç±»å‹ï¼ˆç§¯æ/ä¸­æ€§/æ¶ˆæåŠå…·ä½“ç±»å‹ï¼‰
    2. æƒ…ç»ªå¼ºåº¦ï¼ˆè½»åº¦/ä¸­åº¦/å¼ºçƒˆï¼‰
    3. æƒ…ç»ªæ ‡ç­¾
    4. ç½®ä¿¡åº¦
    
    è¿”å›JSONæ ¼å¼ã€‚
    """
    
    response = ai_service.generate_text(prompt, system_instruction="ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æƒ…ç»ªåˆ†æä¸“å®¶")
    emotion_data = parse_emotion_response(response)
    
    return EmotionRecord(
        emotionType=emotion_data['type'],
        emotionIntensity=emotion_data['intensity'],
        emotionTags=emotion_data['tags'],
        confidence=emotion_data['confidence'],
        source=EmotionSource.CONVERSATION,
        context=text
    )
```

#### 5.1.2 è¡Œä¸ºæƒ…ç»ªè¯†åˆ«

**å®ç°æ–¹å¼**:
- **æ´»è·ƒåº¦åˆ†æ**ï¼šåˆ†æç”¨æˆ·æ´»è·ƒåº¦å˜åŒ–
- **äº¤äº’æ¨¡å¼åˆ†æ**ï¼šåˆ†æäº¤äº’æ¨¡å¼å˜åŒ–
- **æ—¶é—´æ¨¡å¼åˆ†æ**ï¼šåˆ†ææ—¶é—´ç›¸å…³çš„è¡Œä¸ºæ¨¡å¼

### 5.2 è®°å¿†æå–AI

#### 5.2.1 å¯¹è¯è®°å¿†æå–

**å®ç°æ–¹å¼**:
```python
# ä¼ªä»£ç ç¤ºä¾‹
def extract_memory_from_conversation(conversation: Conversation) -> List[UserMemory]:
    prompt = f"""
    ä»ä»¥ä¸‹å¯¹è¯ä¸­æå–é‡è¦çš„è®°å¿†ä¿¡æ¯ï¼š
    å¯¹è¯å†…å®¹ï¼š{conversation.messages}
    
    è¯·æå–ï¼š
    1. ä¸ªäººä¿¡æ¯ï¼ˆå§“åã€åå¥½ã€ä¹ æƒ¯ç­‰ï¼‰
    2. é‡è¦äº‹ä»¶
    3. æƒ…æ„Ÿç»å†
    4. åå¥½ä¿¡æ¯
    
    è¿”å›JSONæ ¼å¼ï¼ŒåŒ…å«è®°å¿†ç±»å‹ã€å†…å®¹ã€é‡è¦æ€§ç­‰ã€‚
    """
    
    response = ai_service.generate_text(prompt, system_instruction="ä½ æ˜¯ä¸€ä¸ªè®°å¿†æå–ä¸“å®¶")
    memories = parse_memory_response(response)
    
    return memories
```

#### 5.2.2 è®°å¿†é‡è¦æ€§è¯„ä¼°

**å®ç°æ–¹å¼**:
- **ç”¨æˆ·åé¦ˆ**ï¼šæ ¹æ®ç”¨æˆ·åé¦ˆè¯„ä¼°é‡è¦æ€§
- **ä½¿ç”¨é¢‘ç‡**ï¼šæ ¹æ®ä½¿ç”¨é¢‘ç‡è¯„ä¼°é‡è¦æ€§
- **æƒ…æ„Ÿå¼ºåº¦**ï¼šæ ¹æ®æƒ…æ„Ÿå¼ºåº¦è¯„ä¼°é‡è¦æ€§
- **AIè¯„ä¼°**ï¼šä½¿ç”¨AIè¯„ä¼°è®°å¿†é‡è¦æ€§

### 5.3 APIæ¥å£è®¾è®¡

**åç«¯æ¥å£**:

1. `POST /api/emotions/analyze` - åˆ†ææƒ…ç»ª
   - è¯·æ±‚ä½“ï¼š`{ text, context, source }`
   - è¿”å›ï¼šæƒ…ç»ªåˆ†æç»“æœ

2. `GET /api/emotions/current` - è·å–å½“å‰æƒ…ç»ª
   - è¿”å›ï¼šç”¨æˆ·å½“å‰æƒ…ç»ªçŠ¶æ€

3. `GET /api/emotions/history` - è·å–æƒ…ç»ªå†å²
   - è¯·æ±‚å‚æ•°ï¼š`startDate`, `endDate`, `type`
   - è¿”å›ï¼šæƒ…ç»ªå†å²è®°å½•

4. `GET /api/emotions/trend` - è·å–æƒ…ç»ªè¶‹åŠ¿
   - è¯·æ±‚å‚æ•°ï¼š`period` (day/week/month)
   - è¿”å›ï¼šæƒ…ç»ªè¶‹åŠ¿æ•°æ®

5. `POST /api/memories` - åˆ›å»ºè®°å¿†
   - è¯·æ±‚ä½“ï¼š`{ type, content, importance, ... }`
   - è¿”å›ï¼šåˆ›å»ºçš„è®°å¿†

6. `GET /api/memories` - è·å–è®°å¿†åˆ—è¡¨
   - è¯·æ±‚å‚æ•°ï¼š`type`, `importance`, `keyword`, `page`, `size`
   - è¿”å›ï¼šè®°å¿†åˆ—è¡¨

7. `GET /api/memories/{id}` - è·å–è®°å¿†è¯¦æƒ…
   - è¿”å›ï¼šè®°å¿†è¯¦æƒ…

8. `PUT /api/memories/{id}` - æ›´æ–°è®°å¿†
   - è¯·æ±‚ä½“ï¼š`{ content, importance, ... }`
   - è¿”å›ï¼šæ›´æ–°åçš„è®°å¿†

9. `DELETE /api/memories/{id}` - åˆ é™¤è®°å¿†
   - è¿”å›ï¼šæ“ä½œç»“æœ

10. `GET /api/memories/search` - æœç´¢è®°å¿†
    - è¯·æ±‚å‚æ•°ï¼š`keyword`, `context`
    - è¿”å›ï¼šç›¸å…³è®°å¿†åˆ—è¡¨

11. `GET /api/memories/recommend` - æ¨èè®°å¿†
    - è¯·æ±‚å‚æ•°ï¼š`context` (å¯¹è¯ä¸Šä¸‹æ–‡ç­‰)
    - è¿”å›ï¼šæ¨èä½¿ç”¨çš„è®°å¿†åˆ—è¡¨

---

## å…­ã€å®æ–½è®¡åˆ’

### 6.1 ç¬¬ä¸€é˜¶æ®µï¼šæƒ…ç»ªè¯†åˆ«åŸºç¡€ï¼ˆ2å‘¨ï¼‰

- [ ] è®¾è®¡æƒ…ç»ªåˆ†ç±»ä½“ç³»
- [ ] å®ç°æ–‡æœ¬æƒ…ç»ªè¯†åˆ«
- [ ] å®ç°æƒ…ç»ªæ•°æ®å­˜å‚¨
- [ ] å®ç°æƒ…ç»ªè®°å½•åŠŸèƒ½

### 6.2 ç¬¬äºŒé˜¶æ®µï¼šæƒ…ç»ªåˆ†æä¸å›åº”ï¼ˆ2å‘¨ï¼‰

- [ ] å®ç°æƒ…ç»ªè¶‹åŠ¿åˆ†æ
- [ ] å®ç°æƒ…ç»ªå›åº”ç³»ç»Ÿ
- [ ] å®ç°æƒ…ç»ªå¯è§†åŒ–
- [ ] å®ç°ä¸»åŠ¨å…³æ€€åŠŸèƒ½

### 6.3 ç¬¬ä¸‰é˜¶æ®µï¼šè®°å¿†ç³»ç»ŸåŸºç¡€ï¼ˆ2å‘¨ï¼‰

- [ ] è®¾è®¡è®°å¿†åˆ†ç±»ä½“ç³»
- [ ] å®ç°è®°å¿†æå–åŠŸèƒ½
- [ ] å®ç°è®°å¿†å­˜å‚¨ç³»ç»Ÿ
- [ ] å®ç°è®°å¿†æ£€ç´¢åŠŸèƒ½

### 6.4 ç¬¬å››é˜¶æ®µï¼šè®°å¿†åº”ç”¨ä¸ä¼˜åŒ–ï¼ˆ2å‘¨ï¼‰

- [ ] å®ç°è®°å¿†åº”ç”¨åŠŸèƒ½
- [ ] å®ç°è®°å¿†å±•ç¤ºå’Œç®¡ç†
- [ ] å®ç°æƒ…ç»ªè®°å¿†èåˆ
- [ ] ä¼˜åŒ–ä¸ªæ€§åŒ–äº¤äº’

### 6.5 ç¬¬äº”é˜¶æ®µï¼šæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰

- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- [ ] Bugä¿®å¤

---

## ä¸ƒã€é¢„æœŸæ•ˆæœ

1. **æƒ…ç»ªç†è§£**ï¼šç³»ç»Ÿèƒ½å¤Ÿå‡†ç¡®ç†è§£ç”¨æˆ·çš„æƒ…ç»ªçŠ¶æ€
2. **æƒ…æ„Ÿå›åº”**ï¼šç³»ç»Ÿèƒ½å¤Ÿæ ¹æ®æƒ…ç»ªæä¾›æ°å½“çš„å›åº”
3. **è®°å¿†èƒ½åŠ›**ï¼šç³»ç»Ÿèƒ½å¤Ÿè®°ä½ç”¨æˆ·çš„é‡è¦ä¿¡æ¯
4. **ä¸ªæ€§åŒ–**ï¼šåŸºäºè®°å¿†æä¾›ä¸ªæ€§åŒ–çš„äº¤äº’ä½“éªŒ
5. **æƒ…æ„Ÿè¿æ¥**ï¼šé€šè¿‡æƒ…ç»ªæ„ŸçŸ¥å’Œè®°å¿†å¢å¼ºæƒ…æ„Ÿè¿æ¥

---

**ä¸‹ä¸€é˜¶æ®µé¢„è§ˆ**: 
- ç¬¬ä¸‰é˜¶æ®µå°†æ¶µç›–é™ªä¼´å¼äº¤äº’ç³»ç»Ÿã€æˆé•¿è®°å½•ç³»ç»Ÿ
- ç¬¬å››é˜¶æ®µå°†æ¶µç›–æƒ…æ„Ÿè¡¨è¾¾æ‰©å±•ã€ç¤¾äº¤æ¸©åº¦æå‡

