# 温暖系统管理端需求分析 - 第一部分：总体概述与基础管理

**文档版本**: V1.0  
**编写日期**: 2025-12-30  
**功能模块**: 温暖系统管理端  
**目标**: 为温暖系统提供后台管理功能，支持管理员对温度感系统进行监控、配置和管理

---

## 一、需求概述

### 1.1 背景

温暖系统（温度感系统）是HeartSphere的核心功能之一，包括四个阶段的完整功能：

1. **第一阶段**：视觉优化与情感表达（UI/UX优化、角色表情动作、对话优化）
2. **第二阶段**：情绪感知与个性化记忆（情绪识别、记忆系统、情绪响应）
3. **第三阶段**：陪伴式交互与成长记录（主动关怀、陪伴活动、成长追踪）
4. **第四阶段**：情感表达扩展与社交温度（多样化表达、社交互动、温暖传播）

为了确保温暖系统的正常运行和优化，需要提供完善的后台管理功能，让管理员能够：

1. **监控系统状态**：实时监控温暖系统的运行状态
2. **管理配置参数**：管理各功能模块的配置参数
3. **查看用户数据**：查看用户情绪、记忆、成长等数据（脱敏后）
4. **数据分析**：分析系统使用情况和效果
5. **内容管理**：管理表情、动作、模板等内容资源

### 1.2 核心功能模块

管理端分为以下几个部分：

**第一部分：总体概述与基础管理**
- 系统概览
- 基础配置管理
- 用户数据查看

**第二部分：情绪感知与记忆管理**
- 情绪识别监控
- 个性化记忆管理
- 情绪响应管理

**第三部分：陪伴交互与成长管理**
- 陪伴交互监控
- 成长记录管理
- 主动关怀管理

**第四部分：内容管理与统计分析**
- 内容资源管理
- 使用统计分析
- 系统优化工具

### 1.3 设计原则

1. **简洁易用**：管理界面简洁直观，易于操作
2. **隐私保护**：严格保护用户隐私，数据脱敏处理
3. **实时监控**：提供实时监控功能，及时发现问题
4. **数据可视化**：通过图表和报表展示数据
5. **可扩展性**：设计可扩展，支持未来功能扩展

---

## 二、系统概览

### 2.1 仪表板

#### 2.1.1 功能描述

提供温暖系统的整体概览，显示关键指标和状态信息。

#### 2.1.2 关键指标

**1. 系统状态**

- **系统运行状态**：正常运行/异常/维护中
- **服务可用性**：服务可用率
- **最后更新时间**：数据最后更新时间

**2. 用户数据统计**

- **活跃用户数**：使用温暖系统的活跃用户数（日/周/月）
- **情绪识别总数**：累计情绪识别次数
- **记忆创建总数**：累计记忆创建数量
- **陪伴交互次数**：累计陪伴交互次数
- **成长记录总数**：累计成长记录数量

**3. 功能使用统计**

- **表情动作使用**：表情和动作的使用统计
- **模板使用**：各种模板的使用统计
- **社交互动**：社交互动功能的使用统计

**4. 性能指标**

- **平均响应时间**：各项操作的平均响应时间
- **成功率**：操作成功率
- **错误率**：操作错误率

**5. 趋势图表**

- **用户增长趋势**：用户数量增长趋势图
- **功能使用趋势**：各功能使用量趋势图
- **情绪分布趋势**：用户情绪分布趋势图

#### 2.1.3 实时监控

- **实时数据更新**：关键指标实时更新
- **异常告警**：系统异常时显示告警信息
- **快速操作**：提供快速操作入口

---

### 2.2 导航菜单

#### 2.2.1 菜单结构

- **系统概览**：仪表板
- **基础管理**
  - 系统配置
  - 用户数据查看
- **情绪感知管理**
  - 情绪识别监控
  - 记忆数据管理
  - 情绪响应管理
- **陪伴交互管理**
  - 陪伴交互监控
  - 成长记录管理
  - 主动关怀管理
- **内容管理**
  - 表情动作管理
  - 模板管理
  - 内容资源管理
- **统计分析**
  - 使用统计
  - 数据分析
- **系统工具**
  - 数据维护
  - 日志查询

---

## 三、基础配置管理

### 3.1 系统配置

#### 3.1.1 功能描述

管理温暖系统的全局配置参数。

#### 3.1.2 配置项

**1. 视觉配置**

- **主题配置**：主题色彩、字体等配置
- **动画配置**：动画效果相关配置
- **视觉效果配置**：光影效果等配置

**2. 情绪识别配置**

- **识别策略**：情绪识别策略配置
- **识别阈值**：情绪识别的阈值设置
- **识别模型**：使用的识别模型配置

**3. 记忆系统配置**

- **提取规则**：记忆提取规则配置
- **存储策略**：记忆存储策略配置
- **检索配置**：记忆检索相关配置

**4. 陪伴交互配置**

- **主动关怀配置**：主动关怀的触发条件和频率
- **陪伴活动配置**：陪伴活动相关配置
- **响应策略**：交互响应策略配置

**5. 成长记录配置**

- **记录规则**：成长记录规则配置
- **里程碑配置**：里程碑定义和配置
- **统计配置**：成长统计相关配置

#### 3.1.3 配置管理

- **查看配置**：查看当前配置
- **修改配置**：修改配置参数（需要权限）
- **配置验证**：修改前验证配置有效性
- **配置保存**：保存配置更改
- **配置历史**：查看配置变更历史
- **配置回滚**：回滚到之前的配置版本

---

### 3.2 用户数据查看

#### 3.2.1 功能描述

查看用户的温暖系统相关数据（脱敏后），用于了解使用情况和问题排查。

#### 3.2.2 用户搜索

- **用户ID搜索**：按用户ID搜索
- **用户名搜索**：按用户名搜索
- **邮箱搜索**：按邮箱搜索
- **高级搜索**：多条件组合搜索

#### 3.2.3 用户数据概览

**1. 基本信息**

- **用户ID**：用户唯一标识
- **用户名**：用户名称
- **注册时间**：用户注册时间
- **最后活动时间**：用户最后活动时间

**2. 温暖系统使用统计**

- **情绪记录数**：用户的情绪记录总数
- **记忆数量**：用户的记忆数据数量
- **陪伴交互次数**：陪伴交互的总次数
- **成长记录数**：成长记录的总数
- **社交互动次数**：社交互动的总次数

**3. 使用情况**

- **使用时长**：使用温暖系统的总时长
- **使用频率**：使用频率统计
- **功能使用分布**：各功能的使用分布

#### 3.2.4 数据查看限制

- **数据脱敏**：所有显示的数据进行脱敏处理
- **权限控制**：只有授权人员可以查看
- **查看日志**：记录所有数据查看日志
- **隐私保护**：严格保护用户隐私，不显示敏感信息

---

## 四、权限管理

### 4.1 角色权限

#### 4.1.1 角色定义

- **超级管理员**：拥有所有权限
- **系统管理员**：拥有系统配置和管理权限
- **数据管理员**：拥有数据查看和管理权限
- **内容管理员**：拥有内容资源管理权限
- **运营人员**：拥有基础查看和运营权限

#### 4.1.2 权限列表

**1. 系统配置权限**

- 查看系统配置
- 修改系统配置
- 查看配置历史
- 回滚配置

**2. 用户数据权限**

- 查看用户列表
- 查看用户数据（脱敏后）
- 导出用户数据（受限）

**3. 内容管理权限**

- 查看内容资源
- 编辑内容资源
- 删除内容资源
- 上传内容资源

**4. 监控权限**

- 查看系统监控
- 查看统计数据
- 查看性能指标
- 查看告警信息

**5. 日志权限**

- 查看操作日志
- 查看系统日志
- 导出日志

---

## 五、数据结构设计

### 5.1 系统配置表

**表名**: `warmth_system_configs`

**字段设计**:
- `id` (BIGINT, PRIMARY KEY): 配置ID
- `config_key` (VARCHAR, NOT NULL, UNIQUE): 配置键
- `config_value` (TEXT, NOT NULL): 配置值（JSON格式）
- `config_type` (VARCHAR, NOT NULL): 配置类型（visual/emotion/memory/companion/growth）
- `description` (TEXT): 配置说明
- `is_enabled` (BOOLEAN, DEFAULT TRUE): 是否启用
- `updated_at` (DATETIME, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP): 更新时间
- `updated_by` (BIGINT): 更新人ID

**索引**:
- `idx_config_key` (config_key)
- `idx_config_type` (config_type)

---

### 5.2 配置变更日志表

**表名**: `warmth_config_change_logs`

**字段设计**:
- `id` (BIGINT, PRIMARY KEY): 日志ID
- `config_id` (BIGINT, NOT NULL): 配置ID
- `change_type` (VARCHAR, NOT NULL): 变更类型（create/update/delete）
- `old_value` (TEXT): 旧值
- `new_value` (TEXT): 新值
- `change_reason` (TEXT): 变更原因
- `changed_by` (BIGINT, NOT NULL): 变更人ID
- `changed_at` (DATETIME, DEFAULT CURRENT_TIMESTAMP): 变更时间

**索引**:
- `idx_config` (config_id, changed_at)
- `idx_changed_by` (changed_by, changed_at)

---

## 六、API接口设计

### 6.1 系统概览接口

**接口**: `GET /api/admin/warmth/dashboard`

**功能**: 获取系统概览数据

**响应数据**:
- `systemStatus` (object): 系统状态
- `statistics` (object): 统计数据
- `performanceMetrics` (object): 性能指标
- `trends` (array): 趋势数据

---

### 6.2 系统配置接口

**接口**: `GET /api/admin/warmth/configs`

**功能**: 获取系统配置列表

**请求参数**:
- `configType` (string): 配置类型

**响应数据**:
- `configs` (array): 配置列表

---

**接口**: `POST /api/admin/warmth/config`

**功能**: 创建或更新系统配置

**请求参数**:
- `configKey` (string, required): 配置键
- `configValue` (object, required): 配置值
- `configType` (string, required): 配置类型
- `description` (string): 配置说明

**响应数据**:
- `configId` (long): 配置ID
- `success` (boolean): 是否成功

---

### 6.3 用户数据查看接口

**接口**: `GET /api/admin/warmth/users`

**功能**: 搜索用户

**请求参数**:
- `keyword` (string): 搜索关键词
- `page` (integer): 页码
- `size` (integer): 每页数量

**响应数据**:
- `users` (array): 用户列表（基本信息）
- `total` (integer): 总记录数

---

**接口**: `GET /api/admin/warmth/users/{userId}/summary`

**功能**: 获取用户使用概览（脱敏后）

**请求参数**:
- `userId` (long, required): 用户ID

**响应数据**:
- `userInfo` (object): 用户基本信息
- `usageStats` (object): 使用统计（脱敏后）
- `summary` (object): 使用摘要

---

## 七、实施计划

### 7.1 第一阶段：基础功能（1周）

- [ ] 设计管理端整体架构
- [ ] 开发系统概览仪表板
- [ ] 开发基础配置管理功能
- [ ] 开发用户数据查看功能
- [ ] 实现权限控制

### 7.2 后续阶段

- 第二部分：情绪感知与记忆管理
- 第三部分：陪伴交互与成长管理
- 第四部分：内容管理与统计分析

---

## 八、验收标准

### 8.1 功能验收

- ✅ 系统概览能够正确显示关键指标
- ✅ 系统配置功能完整可用
- ✅ 用户数据查看功能正常（数据脱敏）
- ✅ 权限控制有效

### 8.2 性能验收

- ✅ 页面加载时间 < 2秒
- ✅ 数据查询响应时间 < 1秒
- ✅ 系统稳定可靠

### 8.3 隐私保护验收

- ✅ 所有用户数据都进行了脱敏处理
- ✅ 敏感信息不显示
- ✅ 数据访问有完整的日志记录

---

## 九、风险和注意事项

### 9.1 隐私风险

- **数据隐私**：用户情绪、记忆等数据涉及隐私，需要严格脱敏
- **访问控制**：需要严格控制数据访问权限
- **日志记录**：所有数据访问都要记录日志

### 9.2 技术风险

- **数据量大**：随着用户增长，数据量可能很大，需要优化性能
- **实时性要求**：部分功能需要实时监控，需要保证实时性

### 9.3 注意事项

- 所有用户数据必须进行脱敏处理
- 敏感信息（如具体对话内容）不得显示
- 数据访问需要权限控制和日志记录
- 定期审查数据访问日志
- 遵守数据保护相关法规

---

**文档状态**: 第一部分需求分析已完成，待后续部分补充

