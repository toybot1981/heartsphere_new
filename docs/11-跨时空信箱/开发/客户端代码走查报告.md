# é‚®ç®±å®¢æˆ·ç«¯ä»£ç èµ°æŸ¥æŠ¥å‘Š

## èµ°æŸ¥æ—¥æœŸ
2025-12-31

## èµ°æŸ¥èŒƒå›´
- APIæœåŠ¡å±‚ (`frontend/services/api/mailbox/`)
- ç±»å‹å®šä¹‰ (`frontend/types/mailbox.ts`)
- UIç»„ä»¶ (`frontend/components/mailbox/`)
- ä¸»åº”ç”¨é›†æˆ (`frontend/App.tsx`)

---

## ğŸ”´ ä¸¥é‡é—®é¢˜

### 1. ç±»å‹å®šä¹‰é‡å¤å’Œä¸ä¸€è‡´

**ä½ç½®**: `frontend/types/mailbox.ts:199-202`

```typescript
// é—®é¢˜ï¼šUnreadCountæ¥å£æœ‰é‡å¤å­—æ®µå®šä¹‰
export interface UnreadCount {
  totalUnread: number;
  total?: number; // å…¼å®¹å­—æ®µ
  categoryUnread?: Record<string, number>;
  // ...
  esoulLetter: number;  // âŒ é‡å¤å®šä¹‰
  resonance: number;
  system: number;
  userMessage: number;
  esoulLetter: number;  // âŒ é‡å¤å®šä¹‰ï¼ˆç¬¬199è¡Œå’Œç¬¬201è¡Œéƒ½æœ‰ï¼‰
  resonance: number;
  system: number;
  userMessage: number;
}
```

**å½±å“**: TypeScriptç¼–è¯‘é”™è¯¯ï¼Œæ¥å£å®šä¹‰æ— æ•ˆ

**ä¿®å¤å»ºè®®**:
```typescript
export interface UnreadCount {
  totalUnread: number;
  total?: number; // å…¼å®¹å­—æ®µ
  categoryUnread?: Record<string, number>;
  // å¯é€‰ï¼šä¿ç•™å…¼å®¹å­—æ®µ
  esoulLetter?: number;
  resonance?: number;
  system?: number;
  userMessage?: number;
}
```

---

### 2. æ¶ˆæ¯åˆ†ç±»åˆ¤æ–­é€»è¾‘ä¸ä¸€è‡´

**ä½ç½®**: `frontend/components/mailbox/MessageList.tsx:229-238`

```typescript
// é—®é¢˜ï¼šä½¿ç”¨äº†å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œè€Œä¸æ˜¯æšä¸¾å€¼
const isESoulLetter = message.messageCategory === 'ESOUL_LETTER' || 
                      message.senderType === 'ESOUL';
```

**å½±å“**: 
- å¦‚æœåç«¯è¿”å›å°å†™å€¼ï¼ˆå¦‚`'esoul_letter'`ï¼‰ï¼Œåˆ¤æ–­ä¼šå¤±è´¥
- ä»£ç ä¸­æ··ç”¨äº†å­—ç¬¦ä¸²å­—é¢é‡å’Œæšä¸¾å€¼

**ä¿®å¤å»ºè®®**:
```typescript
import { MessageCategory, SenderType } from '../../types/mailbox';

const isESoulLetter = message.messageCategory === MessageCategory.ESOUL_LETTER || 
                      message.senderType === SenderType.ESOUL;
```

**åŒæ ·çš„é—®é¢˜å‡ºç°åœ¨**:
- `MessageDetail.tsx:74, 109`
- å…¶ä»–ç»„ä»¶ä¸­çš„åˆ†ç±»åˆ¤æ–­

---

### 3. APIå“åº”è§£æé€»è¾‘å¤æ‚ä¸”å®¹æ˜“å‡ºé”™

**ä½ç½®**: `frontend/services/api/mailbox/mailbox.ts:73-90`

```typescript
// é—®é¢˜ï¼šå¤šå±‚åµŒå¥—çš„å“åº”è§£æï¼Œéš¾ä»¥ç»´æŠ¤
const data = await response.json();
if (data && typeof data === 'object' && 'data' in data && 'content' in data.data) {
  return data.data;
}
if (data && typeof data === 'object' && 'content' in data) {
  return data;
}
return data;
```

**å½±å“**: 
- å¦‚æœåç«¯å“åº”æ ¼å¼å˜åŒ–ï¼Œå‰ç«¯å¯èƒ½æ— æ³•æ­£ç¡®è§£æ
- ä»£ç é‡å¤ï¼ˆå¤šä¸ªAPIå‡½æ•°éƒ½æœ‰ç±»ä¼¼çš„è§£æé€»è¾‘ï¼‰

**ä¿®å¤å»ºè®®**: åˆ›å»ºç»Ÿä¸€çš„å“åº”è§£æå·¥å…·å‡½æ•°

```typescript
// åœ¨ mailbox.ts ä¸­æ·»åŠ 
function parseApiResponse<T>(data: any): T {
  // å¦‚æœæ˜¯ApiResponseæ ¼å¼ï¼Œæå–dataå­—æ®µ
  if (data && typeof data === 'object' && 'data' in data) {
    // æ£€æŸ¥æ˜¯å¦æ˜¯Pageæ ¼å¼ï¼ˆæœ‰contentå­—æ®µï¼‰
    if ('content' in data.data) {
      return data.data as T;
    }
    return data.data as T;
  }
  // ç›´æ¥è¿”å›
  return data as T;
}

// ä½¿ç”¨
const data = await response.json();
return parseApiResponse<Page<MailboxMessage>>(data);
```

---

## ğŸŸ¡ ä¸­ç­‰é—®é¢˜

### 4. ç¼ºå°‘é”™è¯¯å¤„ç†çš„ç»Ÿä¸€æœºåˆ¶

**ä½ç½®**: æ‰€æœ‰APIè°ƒç”¨å‡½æ•°

**é—®é¢˜**: 
- é”™è¯¯å¤„ç†åˆ†æ•£åœ¨å„ä¸ªå‡½æ•°ä¸­
- é”™è¯¯æ¶ˆæ¯æ ¼å¼ä¸ç»Ÿä¸€
- æŸäº›é”™è¯¯æ²¡æœ‰é€‚å½“çš„ç”¨æˆ·æç¤º

**ä¿®å¤å»ºè®®**: åˆ›å»ºç»Ÿä¸€çš„é”™è¯¯å¤„ç†ä¸­é—´ä»¶

```typescript
// åˆ›å»º errorHandler.ts
export async function handleApiError<T>(
  apiCall: () => Promise<T>,
  defaultMessage: string = 'æ“ä½œå¤±è´¥'
): Promise<T> {
  try {
    return await apiCall();
  } catch (error: any) {
    console.error(`[API Error] ${defaultMessage}:`, error);
    
    // ç»Ÿä¸€é”™è¯¯æç¤º
    const message = error.message || defaultMessage;
    // å¯ä»¥é›†æˆtoasté€šçŸ¥
    // showErrorToast(message);
    
    throw error;
  }
}
```

---

### 5. æ¶ˆæ¯åˆ—è¡¨åˆ†é¡µé€»è¾‘å¯èƒ½å¯¼è‡´é‡å¤åŠ è½½

**ä½ç½®**: `frontend/components/mailbox/MessageList.tsx:25-27`

```typescript
useEffect(() => {
  loadMessages();
}, [category, filter, page, token]);
```

**é—®é¢˜**: 
- `loadMessages`å‡½æ•°æ²¡æœ‰åœ¨ä¾èµ–æ•°ç»„ä¸­ï¼Œä½†ä½¿ç”¨äº†è¿™äº›å˜é‡
- å¯èƒ½å¯¼è‡´é—­åŒ…é—®é¢˜ï¼Œä½¿ç”¨æ—§çš„`page`å€¼

**ä¿®å¤å»ºè®®**:
```typescript
const loadMessages = useCallback(async () => {
  // ...
}, [category, filter, page, token]);

useEffect(() => {
  loadMessages();
}, [loadMessages]);
```

---

### 6. æœªè¯»æ•°é‡APIç¼ºå°‘åˆ·æ–°æœºåˆ¶

**ä½ç½®**: `frontend/components/mailbox/UnreadBadge.tsx:28`

**é—®é¢˜**: 
- æ¯30ç§’è½®è¯¢å¯èƒ½ä¸å¤ŸåŠæ—¶
- æ²¡æœ‰åœ¨ç”¨æˆ·æ“ä½œï¼ˆæ ‡è®°å·²è¯»ã€åˆ é™¤æ¶ˆæ¯ç­‰ï¼‰åä¸»åŠ¨åˆ·æ–°

**ä¿®å¤å»ºè®®**: 
- æ·»åŠ äº‹ä»¶ç›‘å¬æœºåˆ¶ï¼Œåœ¨ç›¸å…³æ“ä½œååˆ·æ–°
- ä½¿ç”¨WebSocketæˆ–Server-Sent Eventså®ç°å®æ—¶æ›´æ–°

---

### 7. æ¶ˆæ¯è¯¦æƒ…ç»„ä»¶ç¼ºå°‘åŠ è½½çŠ¶æ€

**ä½ç½®**: `frontend/components/mailbox/MessageDetail.tsx`

**é—®é¢˜**: 
- ç»„ä»¶ç›´æ¥æ¥æ”¶`message`å‚æ•°ï¼Œä½†å®é™…å¯èƒ½éœ€è¦ä»APIé‡æ–°åŠ è½½å®Œæ•´æ•°æ®
- æ²¡æœ‰å¤„ç†æ¶ˆæ¯ä¸å­˜åœ¨çš„æƒ…å†µ

**ä¿®å¤å»ºè®®**:
```typescript
const [message, setMessage] = useState<MailboxMessage | null>(initialMessage);
const [loading, setLoading] = useState(false);

useEffect(() => {
  if (messageId) {
    loadMessageDetail(messageId);
  }
}, [messageId]);

const loadMessageDetail = async (id: number) => {
  setLoading(true);
  try {
    const data = await mailboxApi.getMessageById(id, token);
    setMessage(data);
  } catch (error) {
    // å¤„ç†é”™è¯¯
  } finally {
    setLoading(false);
  }
};
```

---

## ğŸŸ¢ æ”¹è¿›å»ºè®®

### 8. ä»£ç é‡å¤ï¼šæ¶ˆæ¯ç±»å‹åˆ¤æ–­é€»è¾‘

**é—®é¢˜**: `MessageList.tsx`å’Œ`MessageDetail.tsx`ä¸­éƒ½æœ‰ç›¸åŒçš„æ¶ˆæ¯ç±»å‹åˆ¤æ–­é€»è¾‘

**å»ºè®®**: æå–ä¸ºå·¥å…·å‡½æ•°

```typescript
// utils/mailboxHelpers.ts
export function isESoulLetter(message: MailboxMessage): boolean {
  return message.messageCategory === MessageCategory.ESOUL_LETTER || 
         message.senderType === SenderType.ESOUL;
}

export function isResonanceMessage(message: MailboxMessage): boolean {
  return message.messageCategory === MessageCategory.RESONANCE || 
         message.senderType === SenderType.HEARTSPHERE;
}

export function isSystemMessage(message: MailboxMessage): boolean {
  return message.messageCategory === MessageCategory.SYSTEM || 
         message.senderType === SenderType.SYSTEM;
}
```

---

### 9. æ§åˆ¶å°æ—¥å¿—è¿‡å¤š

**ä½ç½®**: å¤šä¸ªç»„ä»¶ä¸­éƒ½æœ‰`console.log`ç”¨äºè°ƒè¯•

**é—®é¢˜**: 
- ç”Ÿäº§ç¯å¢ƒä¸åº”è¯¥æœ‰è¿™ä¹ˆå¤šè°ƒè¯•æ—¥å¿—
- å½±å“æ€§èƒ½

**å»ºè®®**: 
- ä½¿ç”¨ç¯å¢ƒå˜é‡æ§åˆ¶æ—¥å¿—è¾“å‡º
- æˆ–ä½¿ç”¨ä¸“é—¨çš„æ—¥å¿—åº“ï¼ˆå¦‚`winston`ã€`pino`ï¼‰

```typescript
const isDev = process.env.NODE_ENV === 'development';
export const logger = {
  log: (...args: any[]) => isDev && console.log(...args),
  error: (...args: any[]) => console.error(...args),
  warn: (...args: any[]) => console.warn(...args),
};
```

---

### 10. ç¼ºå°‘æ¶ˆæ¯å›å¤åˆ—è¡¨API

**ä½ç½®**: `frontend/services/api/mailbox/mailbox.ts`

**é—®é¢˜**: 
- `MessageDetail.tsx`ä¸­æåˆ°äº†å›å¤åˆ—è¡¨ï¼Œä½†æ²¡æœ‰å¯¹åº”çš„APIå‡½æ•°
- æ—§ç³»ç»Ÿæœ‰`getLetterReplies`ï¼Œæ–°ç³»ç»Ÿç¼ºå°‘ç±»ä¼¼åŠŸèƒ½

**å»ºè®®**: æ·»åŠ è·å–æ¶ˆæ¯å›å¤åˆ—è¡¨çš„API

```typescript
/**
 * è·å–æ¶ˆæ¯çš„å›å¤åˆ—è¡¨
 */
export async function getMessageReplies(
  messageId: number,
  token: string
): Promise<MailboxMessage[]> {
  const response = await fetch(`${API_BASE}/messages/${messageId}/replies`, {
    method: 'GET',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json',
    },
  });

  if (!response.ok) {
    throw new Error(`è·å–å›å¤åˆ—è¡¨å¤±è´¥: ${response.statusText}`);
  }

  const data = await response.json();
  return parseApiResponse<MailboxMessage[]>(data);
}
```

**æ³¨æ„**: éœ€è¦ç¡®è®¤åç«¯æ˜¯å¦æœ‰å¯¹åº”çš„APIç«¯ç‚¹

---

### 11. APIé…ç½®ä¸ä¸€è‡´

**ä½ç½®**: `frontend/services/api/mailbox/mailbox.ts:26`

```typescript
const API_BASE = getApiUrl('/mailbox');
```

**é—®é¢˜**: éœ€è¦ç¡®è®¤`getApiUrl`å‡½æ•°æ˜¯å¦æ­£ç¡®é…ç½®

**æ£€æŸ¥ç‚¹**:
- `getApiUrl`æ˜¯å¦æ­£ç¡®å¤„ç†äº†åŸºç¡€è·¯å¾„
- æ˜¯å¦ä¸åç«¯APIè·¯å¾„ä¸€è‡´ï¼ˆ`/api/mailbox`ï¼‰

---

### 12. ç¼ºå°‘æ¶ˆæ¯åˆ›å»ºAPIçš„ç±»å‹éªŒè¯

**ä½ç½®**: `frontend/services/api/mailbox/mailbox.ts:652`

**é—®é¢˜**: `createMessage`å‡½æ•°æ¥æ”¶çš„`CreateMessageRequest`ç±»å‹å¯èƒ½ä¸å®Œæ•´

**å»ºè®®**: æ·»åŠ è¿è¡Œæ—¶éªŒè¯æˆ–ä½¿ç”¨`zod`ç­‰åº“è¿›è¡ŒéªŒè¯

```typescript
import { z } from 'zod';

const CreateMessageRequestSchema = z.object({
  receiverId: z.number(),
  senderType: z.nativeEnum(SenderType),
  // ... å…¶ä»–å­—æ®µ
});

export async function createMessage(
  request: CreateMessageRequest,
  token: string
): Promise<MailboxMessage> {
  // éªŒè¯è¯·æ±‚æ•°æ®
  const validatedRequest = CreateMessageRequestSchema.parse(request);
  // ...
}
```

---

### 13. æ¶ˆæ¯å¡ç‰‡ç»„ä»¶æ ·å¼å¤æ‚

**ä½ç½®**: `frontend/components/mailbox/MessageList.tsx:240-259`

**é—®é¢˜**: 
- æ ·å¼ç±»åè¿‡é•¿ï¼Œéš¾ä»¥ç»´æŠ¤
- æ¡ä»¶æ ·å¼é€»è¾‘å¤æ‚

**å»ºè®®**: æå–æ ·å¼ç±»ååˆ°å¸¸é‡æˆ–ä½¿ç”¨CSS Modules

```typescript
const getMessageCardStyles = (message: MailboxMessage) => {
  const baseStyles = 'p-5 rounded-2xl cursor-pointer transition-all duration-300';
  const isESoul = isESoulLetter(message);
  const isResonance = isResonanceMessage(message);
  const isSystem = isSystemMessage(message);
  
  if (isESoul) {
    return message.isRead 
      ? `${baseStyles} bg-esoul-read`
      : `${baseStyles} bg-esoul-unread`;
  }
  // ...
};
```

---

### 14. ç¼ºå°‘ç©ºçŠ¶æ€å¤„ç†çš„ç»Ÿä¸€ç»„ä»¶

**ä½ç½®**: å¤šä¸ªç»„ä»¶ä¸­éƒ½æœ‰ç©ºçŠ¶æ€çš„JSXä»£ç 

**å»ºè®®**: åˆ›å»ºé€šç”¨çš„ç©ºçŠ¶æ€ç»„ä»¶

```typescript
interface EmptyStateProps {
  icon?: string;
  title: string;
  description?: string;
}

export const EmptyState: React.FC<EmptyStateProps> = ({ icon, title, description }) => (
  <div className="flex flex-col items-center justify-center h-full text-slate-500">
    {icon && <div className="text-6xl mb-6 animate-bounce">{icon}</div>}
    <p className="text-lg font-medium mb-2">{title}</p>
    {description && <p className="text-sm text-slate-600">{description}</p>}
  </div>
);
```

---

## ğŸ“‹ ä»£ç è´¨é‡é—®é¢˜

### 15. æ³¨é‡Šçš„è¿ç§»ä»£ç åº”è¯¥åˆ é™¤

**ä½ç½®**: `frontend/components/mailbox/UnifiedMailboxModal.tsx`

**é—®é¢˜**: å¤§é‡è¢«æ³¨é‡Šæ‰çš„è¿ç§»ç›¸å…³ä»£ç åº”è¯¥åˆ é™¤ï¼Œä¿æŒä»£ç æ•´æ´

**å»ºè®®**: å¦‚æœç¡®å®šä¸å†éœ€è¦ï¼Œåˆ é™¤æ‰€æœ‰æ³¨é‡Šçš„è¿ç§»ä»£ç 

---

### 16. ç¼ºå°‘TypeScriptä¸¥æ ¼æ¨¡å¼æ£€æŸ¥

**é—®é¢˜**: æŸäº›åœ°æ–¹ä½¿ç”¨äº†`any`ç±»å‹ï¼Œåº”è¯¥ä½¿ç”¨æ›´å…·ä½“çš„ç±»å‹

**ä½ç½®**: 
- `frontend/types/mailbox.ts:264` - `contentData?: any;`
- `frontend/services/api/mailbox/mailbox.ts:78` - å¤šå¤„ä½¿ç”¨`any`

**å»ºè®®**: 
- å®šä¹‰`contentData`çš„å…·ä½“ç±»å‹æˆ–ä½¿ç”¨è”åˆç±»å‹
- é¿å…ä½¿ç”¨`any`ï¼Œä½¿ç”¨`unknown`æˆ–å…·ä½“ç±»å‹

---

### 17. ç¼ºå°‘å•å…ƒæµ‹è¯•

**é—®é¢˜**: æ‰€æœ‰ç»„ä»¶å’ŒAPIå‡½æ•°éƒ½æ²¡æœ‰å•å…ƒæµ‹è¯•

**å»ºè®®**: 
- ä¸ºAPIæœåŠ¡å±‚æ·»åŠ å•å…ƒæµ‹è¯•
- ä¸ºå…³é”®ç»„ä»¶æ·»åŠ ç»„ä»¶æµ‹è¯•
- ä½¿ç”¨Jest + React Testing Library

---

## ğŸ” æ½œåœ¨Bug

### 18. æ¶ˆæ¯åˆ—è¡¨çš„`page`çŠ¶æ€å¯èƒ½ä¸åŒæ­¥

**ä½ç½®**: `frontend/components/mailbox/MessageList.tsx:64-68`

```typescript
if (page === 0) {
  setMessages(result.content || []);
} else {
  setMessages(prev => [...prev, ...(result.content || [])]);
}
```

**é—®é¢˜**: å¦‚æœ`category`æˆ–`filter`æ”¹å˜æ—¶`page`æ²¡æœ‰é‡ç½®ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ··ä¹±

**å½“å‰ä»£ç **: `setFilter`æ—¶ä¼šé‡ç½®`page`ï¼Œä½†å¯èƒ½éœ€è¦æ›´å¥å£®çš„æœºåˆ¶

---

### 19. æœªè¯»æ•°é‡è®¡ç®—å¯èƒ½æœ‰è¯¯å·®

**ä½ç½®**: `frontend/components/mailbox/UnreadBadge.tsx:48`

```typescript
const total = unreadCount?.totalUnread || unreadCount?.total || 0;
```

**é—®é¢˜**: 
- å¦‚æœåç«¯è¿”å›`totalUnread: 0`ï¼Œä¼šfallbackåˆ°`total`ï¼Œå¯èƒ½ä¸å‡†ç¡®
- éœ€è¦æ˜ç¡®åç«¯è¿”å›æ ¼å¼

---

### 20. APIé”™è¯¯å“åº”å¤„ç†ä¸ä¸€è‡´

**ä½ç½®**: ä¸åŒAPIå‡½æ•°çš„é”™è¯¯å¤„ç†æ–¹å¼ä¸åŒ

**é—®é¢˜**: 
- `getMessages`æœ‰è¯¦ç»†çš„é”™è¯¯å¤„ç†
- `getMessageById`åªæœ‰ç®€å•çš„é”™è¯¯å¤„ç†
- æŸäº›å‡½æ•°å¯èƒ½æ²¡æœ‰å¤„ç†æ‰€æœ‰é”™è¯¯æƒ…å†µ

**å»ºè®®**: ç»Ÿä¸€é”™è¯¯å¤„ç†é€»è¾‘

---

## âœ… æ€»ç»“

### å¿…é¡»ä¿®å¤ï¼ˆé˜»å¡æ€§é—®é¢˜ï¼‰
1. âœ… ç±»å‹å®šä¹‰é‡å¤é—®é¢˜ï¼ˆ`UnreadCount`æ¥å£ï¼‰
2. âœ… æ¶ˆæ¯åˆ†ç±»åˆ¤æ–­ä½¿ç”¨æšä¸¾è€Œä¸æ˜¯å­—ç¬¦ä¸²

### åº”è¯¥ä¿®å¤ï¼ˆé‡è¦é—®é¢˜ï¼‰
3. âœ… APIå“åº”è§£æé€»è¾‘ç»Ÿä¸€
4. âœ… é”™è¯¯å¤„ç†ç»Ÿä¸€æœºåˆ¶
5. âœ… æ¶ˆæ¯å›å¤åˆ—è¡¨APIç¼ºå¤±

### å»ºè®®æ”¹è¿›ï¼ˆä¼˜åŒ–é¡¹ï¼‰
6. âœ… ä»£ç é‡å¤æå–
7. âœ… æ—¥å¿—ç®¡ç†
8. âœ… ç©ºçŠ¶æ€ç»„ä»¶ç»Ÿä¸€
9. âœ… æ·»åŠ å•å…ƒæµ‹è¯•

---

## ğŸ“ ä¼˜å…ˆçº§ä¿®å¤æ¸…å•

### P0 - ç«‹å³ä¿®å¤
- [ ] ä¿®å¤`UnreadCount`æ¥å£é‡å¤å®šä¹‰
- [ ] ç»Ÿä¸€ä½¿ç”¨æšä¸¾è¿›è¡Œæ¶ˆæ¯åˆ†ç±»åˆ¤æ–­
- [ ] æ·»åŠ æ¶ˆæ¯å›å¤åˆ—è¡¨APIæ”¯æŒ

### P1 - æœ¬å‘¨ä¿®å¤
- [ ] ç»Ÿä¸€APIå“åº”è§£æé€»è¾‘
- [ ] å®Œå–„é”™è¯¯å¤„ç†æœºåˆ¶
- [ ] ä¿®å¤æ¶ˆæ¯åˆ—è¡¨åˆ†é¡µé€»è¾‘

### P2 - ä¸‹ä¸ªè¿­ä»£
- [ ] ä»£ç é‡æ„å’Œæå–é‡å¤é€»è¾‘
- [ ] æ·»åŠ å•å…ƒæµ‹è¯•
- [ ] ä¼˜åŒ–æ ·å¼ä»£ç 

---

## ğŸ”— ç›¸å…³æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒæ–‡ä»¶
- `frontend/services/api/mailbox/mailbox.ts` - APIæœåŠ¡å±‚
- `frontend/types/mailbox.ts` - ç±»å‹å®šä¹‰
- `frontend/components/mailbox/UnifiedMailboxModal.tsx` - ä¸»ç»„ä»¶
- `frontend/components/mailbox/MessageList.tsx` - æ¶ˆæ¯åˆ—è¡¨
- `frontend/components/mailbox/MessageDetail.tsx` - æ¶ˆæ¯è¯¦æƒ…
- `frontend/components/mailbox/UnreadBadge.tsx` - æœªè¯»å¾½ç« 

### ç›¸å…³æ–‡ä»¶
- `frontend/App.tsx` - ä¸»åº”ç”¨é›†æˆ
- `frontend/services/api/base/config.ts` - APIé…ç½®
- `frontend/components/UserProfile.tsx` - ç”¨æˆ·èµ„æ–™ï¼ˆä½¿ç”¨æœªè¯»æ•°é‡ï¼‰
