# 数字生命体交互系统（心域）软件说明书

## 一、软件基本信息

### 1.1 软件名称
**数字生命体交互系统（心域）**
**英文名称：Digital Lifeform Interaction System (HeartSphere)**

### 1.2 软件版本
V1.0.0

### 1.3 软件分类
应用软件 - 人工智能交互平台

### 1.4 开发完成日期
2024年

---

## 二、软件功能说明

### 2.1 软件概述
数字生命体交互系统（心域）是一个基于人工智能技术的数字生命体交互平台，构建了一个与现实世界平行的精神与数据空间。系统通过先进的大语言模型技术，实现了用户与数字生命体（E-Soul）的深度情感交互，支持多时代切片（Era Shard）的访问与管理，为用户提供沉浸式的虚拟角色互动体验。

### 2.2 核心功能模块

#### 2.2.1 用户认证与管理模块
- **用户注册与登录**：支持多种认证方式，包括账号密码登录、微信授权登录
- **用户信息管理**：用户个人资料维护、偏好设置
- **权限管理**：基于JWT的访问控制，支持角色权限分配
- **邀请码系统**：管理员可生成邀请码，控制用户注册

#### 2.2.2 世界与时代管理模块
- **世界创建与管理**：用户可以创建和管理多个虚拟世界
- **时代切片管理**：支持创建不同主题的时代切片（如大学时代、赛博都市、心域诊所等）
- **场景构建**：提供丰富的场景模板和自定义场景构建功能
- **资源管理**：支持图片、音频等多媒体资源的存储和管理

#### 2.2.3 数字生命体（E-Soul）管理模块
- **角色创建**：支持创建具有完整人格设定的数字生命体
- **角色属性管理**：包括姓名、年龄、性别、性格、背景故事、MBTI人格类型等
- **多时代角色**：同一角色可在不同时代切片中呈现不同状态
- **角色互动**：基于大语言模型的智能对话系统

#### 2.2.4 智能对话交互模块
- **实时对话**：基于Google Gemini等大语言模型的实时对话功能
- **上下文记忆**：支持对话历史记录和上下文理解
- **个性化响应**：根据角色设定和用户偏好生成个性化回复
- **多模态支持**：支持文字、图片等多种交互方式

#### 2.2.5 会员与支付模块
- **会员体系**：支持多层级会员订阅计划
- **积分系统**：用户积分获取和消费管理
- **支付集成**：支持微信支付等支付方式
- **订单管理**：支付订单的创建、查询和管理

#### 2.2.6 日记与记录模块
- **日记功能**：用户可记录与数字生命体的互动日记
- **模板系统**：提供多种日记模板
- **历史记录**：对话历史和互动记录的保存与查询

#### 2.2.7 回收站模块
- **软删除机制**：支持数据的软删除和恢复
- **数据恢复**：误删数据的恢复功能

#### 2.2.8 管理后台模块
- **系统数据管理**：管理员可管理系统角色、时代、资源等
- **用户管理**：用户信息查询和管理
- **系统配置**：系统参数配置和管理
- **数据统计**：系统使用情况统计和分析

---

## 三、技术特点

### 3.1 系统架构
系统采用前后端分离的架构：
- **前端**：基于React 19和TypeScript构建的单页应用（SPA）
- **后端**：基于Spring Boot 3.2.0的RESTful API服务

### 3.2 核心技术栈

#### 3.2.1 前端技术
- **框架**：React 19.2.0
- **语言**：TypeScript 5.8.2
- **构建工具**：Vite 5.0.0
- **状态管理**：React Hooks
- **UI组件**：自定义组件库
- **测试框架**：Jest + React Testing Library

#### 3.2.2 后端技术
- **框架**：Spring Boot 3.2.0
- **语言**：Java 17
- **持久层**：Spring Data JPA
- **数据库**：MySQL
- **安全框架**：Spring Security + JWT
- **API文档**：SpringDoc OpenAPI 3.0

#### 3.2.3 大语言模型集成
- **Google Gemini API**：前端直接集成的对话服务
- **多模型适配器**：支持多种大语言模型的统一接口

### 3.3 技术亮点

#### 3.3.1 智能对话系统
- 基于大语言模型的上下文理解和生成能力
- 支持角色人格设定的动态调整
- 多轮对话的上下文记忆和管理

#### 3.3.2 数据持久化
- 基于JPA的ORM映射
- 支持复杂关联关系的管理
- 软删除机制保护数据安全

#### 3.3.3 安全机制
- JWT令牌认证
- Spring Security安全框架
- 基于角色的访问控制（RBAC）

---

## 四、开发环境

### 4.1 前端开发环境
- **Node.js**：v18.0.0及以上
- **包管理器**：npm
- **开发工具**：VS Code / WebStorm
- **浏览器**：Chrome、Firefox、Safari、Edge（最新版本）

### 4.2 后端开发环境
- **JDK**：Java 17及以上
- **构建工具**：Maven 3.6+
- **IDE**：IntelliJ IDEA / Eclipse
- **数据库**：MySQL 8.0+

---

## 五、运行环境

### 5.1 服务器环境
- **操作系统**：Linux（推荐Ubuntu 20.04+）、macOS、Windows Server
- **Java运行环境**：JRE 17或JDK 17
- **Node.js运行环境**：Node.js 18.0.0+（用于前端构建）

### 5.2 数据库环境
- **MySQL**：8.0及以上版本
- **字符集**：UTF-8

### 5.3 网络环境
- **HTTP/HTTPS**：支持HTTP和HTTPS协议
- **API访问**：需要访问Google Gemini API、阿里云通义千问API等外部服务

### 5.4 存储环境
- **文件存储**：支持本地文件系统或云存储服务（OSS、S3等）
- **图片存储**：支持图片上传、存储和访问

---

## 六、软件架构

### 6.1 系统架构图
```
┌─────────────────────────────────────────────────────────┐
│                     用户层                                │
│  Web浏览器 / 移动端浏览器                                  │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│                     前端层                                │
│  React + TypeScript + Vite                               │
│  - 用户界面组件                                           │
│  - 状态管理                                               │
│  - API调用                                                │
│  - Gemini API集成                                         │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│                     网关层                                │
│  Nginx / API Gateway                                     │
└─────────────────────────────────────────────────────────┘
                          │
        ▼
┌──────────────────────┐
│   后端服务层          │
│  Spring Boot 3.2.0   │
│  - RESTful API        │
│  - 业务逻辑           │
│  - 数据访问           │
└──────────────────────┘
        │
        ▼
┌─────────────────────────────────────────────────────────┐
│                     数据层                                │
│  MySQL数据库                                             │
│  - 用户数据                                              │
│  - 角色数据                                              │
│  - 对话记录                                              │
│  - 系统配置                                              │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│                     外部服务层                            │
│  - Google Gemini API                                     │
│  - 阿里云通义千问API                                      │
│  - 微信支付API                                           │
│  - 文件存储服务                                          │
└─────────────────────────────────────────────────────────┘
```

### 6.2 模块划分

#### 6.2.1 前端模块
- **入口模块**（EntryPoint）：应用入口和路由管理
- **认证模块**（LoginModal）：用户登录和注册
- **世界管理模块**（WorldController）：世界和时代的创建与管理
- **角色管理模块**（CharacterCard, PersonaCard）：角色的展示和管理
- **对话模块**（ChatWindow）：实时对话界面
- **场景构建模块**（ScenarioBuilder）：场景创建和编辑
- **日记模块**（RealWorldJournal）：日记记录和查看
- **管理后台模块**（AdminScreen）：系统管理界面
- **移动端模块**（mobile/）：移动端适配组件

#### 6.2.2 后端模块
- **认证模块**（AuthController, security/）：用户认证和授权
- **世界管理模块**（WorldController, World实体）：世界和时代管理
- **角色管理模块**（CharacterController, Character实体）：角色CRUD操作
- **对话模块**（ScriptController, Script实体）：对话脚本管理
- **会员模块**（MembershipController, Membership实体）：会员和积分管理
- **支付模块**（PaymentController, PaymentOrder实体）：支付订单管理
- **资源模块**（ResourceController, ImageController）：资源上传和管理
- **日记模块**（JournalEntryController, JournalEntry实体）：日记管理
- **管理后台模块**（admin/）：系统管理功能

---

## 七、主要功能模块详细说明

### 7.1 用户认证与管理模块

#### 7.1.1 功能描述
提供用户注册、登录、信息管理等功能，支持多种认证方式。

#### 7.1.2 技术实现
- 使用Spring Security框架实现安全认证
- JWT令牌机制实现无状态认证
- 支持微信OAuth2.0授权登录
- 密码加密存储（BCrypt）

#### 7.1.3 主要接口
- `POST /api/auth/register`：用户注册
- `POST /api/auth/login`：用户登录
- `POST /api/auth/wechat`：微信登录
- `GET /api/auth/me`：获取当前用户信息

### 7.2 世界与时代管理模块

#### 7.2.1 功能描述
用户可以创建和管理多个虚拟世界，每个世界包含多个时代切片。

#### 7.2.2 技术实现
- 基于JPA的实体关系映射（World-Era-Character）
- RESTful API设计
- 支持图片上传和存储

#### 7.2.3 主要接口
- `GET /api/worlds`：获取用户的所有世界
- `POST /api/worlds`：创建新世界
- `GET /api/eras`：获取时代列表
- `POST /api/eras`：创建新时代

### 7.3 数字生命体管理模块

#### 7.3.1 功能描述
创建和管理具有完整人格设定的数字生命体，支持多时代切片中的不同状态。

#### 7.3.2 技术实现
- 丰富的角色属性定义（姓名、年龄、性格、背景故事等）
- 支持MBTI人格类型
- 系统提示词（System Instruction）管理
- 角色与时代、世界的关联关系

#### 7.3.3 主要接口
- `GET /api/characters`：获取角色列表
- `POST /api/characters`：创建新角色
- `PUT /api/characters/{id}`：更新角色信息
- `DELETE /api/characters/{id}`：删除角色

### 7.4 智能对话交互模块

#### 7.4.1 功能描述
基于大语言模型的实时对话功能，支持上下文记忆和个性化响应。

#### 7.4.2 技术实现
- 前端直接集成Google Gemini API
- 对话历史记录管理
- 角色系统提示词注入
- 流式响应支持

#### 7.4.3 主要功能
- 实时对话交互
- 对话历史保存
- 上下文理解
- 个性化回复生成

### 7.5 会员与支付模块

#### 7.6.1 功能描述
会员订阅、积分管理和支付功能。

#### 7.6.2 技术实现
- 多层级会员计划管理
- 积分获取和消费记录
- 微信支付集成
- 订单状态管理

#### 7.6.3 主要接口
- `GET /api/memberships`：获取会员信息
- `POST /api/memberships/subscribe`：订阅会员
- `POST /api/payments/create`：创建支付订单
- `POST /api/payments/callback`：支付回调

---

## 八、数据库设计

### 8.1 主要数据表

#### 8.1.1 用户相关表
- **users**：用户基本信息表
- **memberships**：会员信息表
- **point_transactions**：积分交易记录表
- **payment_orders**：支付订单表

#### 8.1.2 内容相关表
- **worlds**：世界表
- **eras**：时代切片表
- **characters**：角色表
- **scripts**：对话脚本表
- **journal_entries**：日记表

#### 8.1.3 系统管理表
- **system_worlds**：系统世界表
- **system_eras**：系统时代表
- **system_characters**：系统角色表
- **system_resources**：系统资源表
- **system_admins**：系统管理员表
- **invite_codes**：邀请码表

### 8.2 数据关系
- 用户（User）→ 世界（World）→ 时代（Era）→ 角色（Character）
- 用户（User）→ 会员（Membership）→ 积分交易（PointTransaction）
- 用户（User）→ 支付订单（PaymentOrder）
- 用户（User）→ 日记（JournalEntry）

---

## 九、安全机制

### 9.1 认证安全
- JWT令牌认证，防止令牌伪造
- 密码BCrypt加密存储
- 令牌过期机制

### 9.2 授权安全
- 基于角色的访问控制（RBAC）
- API接口权限验证
- 资源所有权验证

### 9.3 数据安全
- SQL注入防护（JPA参数化查询）
- XSS攻击防护
- CSRF防护（Spring Security默认支持）

---

## 十、性能优化

### 10.1 前端优化
- 代码分割和懒加载
- 组件缓存
- 图片懒加载

### 10.2 后端优化
- 数据库索引优化
- 查询结果缓存
- 连接池管理

### 10.3 API优化
- RESTful API设计
- 分页查询支持
- 响应数据压缩

---

## 十一、部署说明

### 11.1 前端部署
1. 执行 `npm run build` 构建生产版本
2. 将构建产物部署到Nginx或CDN
3. 配置API代理

### 11.2 后端部署
1. 使用Maven打包：`mvn clean package`
2. 运行JAR包：`java -jar heartsphere-service.jar`
3. 配置数据库连接和外部服务API密钥

---

## 十二、软件创新点

### 12.1 技术创新
1. **多时代切片概念**：创新的数字生命体管理方式，支持同一角色在不同时代的不同状态
2. **多模型适配**：统一接口支持多种大语言模型
3. **前后端分离架构**：现代化的架构设计
4. **智能对话系统**：基于大语言模型的上下文理解和个性化响应

### 12.2 功能创新
1. **沉浸式交互体验**：结合角色设定和上下文理解的智能对话
2. **个性化角色创建**：丰富的角色属性定义和人格设定
3. **场景构建系统**：灵活的虚拟场景创建和管理
4. **多端适配**：支持Web端和移动端

---

## 十三、软件应用场景

### 13.1 主要应用场景
1. **情感陪伴**：用户与数字生命体进行情感交流和陪伴
2. **角色扮演**：在不同时代切片中体验不同的角色互动
3. **心理疏导**：通过心域诊所功能获得心理支持和疏导
4. **创意写作**：利用角色和场景进行创意内容创作

### 13.2 目标用户
- 寻求情感陪伴的用户
- 喜欢角色扮演游戏的用户
- 需要心理支持的用户
- 内容创作者

---

## 十四、版本历史

### V1.0.0（当前版本）
- 基础功能实现
- 用户认证和管理
- 世界、时代、角色管理
- 智能对话功能
- AI Agent工作流引擎
- 会员和支付功能
- 管理后台

---

## 十五、联系方式

**软件开发者**：[开发者信息]
**开发日期**：2024年
**软件版本**：V1.0.0

---

**注：本说明书为软件著作权申请材料，详细描述了数字生命体交互系统（心域）的功能、技术特点、架构设计等内容。**
